import{t as Se,b as le,c as ss}from"../chunks/C3al_oyy.js";import{aw as J,ax as z,ay as Ve,av as Ze,ap as Er,aA as as,ab as Ns,aE as hi,ad as Ms,az as mi,au as Jn,a as re,aB as pi,b as js}from"../chunks/CXBtRYQN.js";import{s as pt}from"../chunks/CnEqC6C6.js";import{i as $t,s as gi,a as lt,b as yi}from"../chunks/D6A_DPMJ.js";import{e as Hn,i as Xn}from"../chunks/CGo8PbHi.js";import{s as ae,u as qe}from"../chunks/SFOVbcPR.js";import{d as Rr,e as _i}from"../chunks/DIJW3dkR.js";import{p as vi}from"../chunks/CSSALvxy.js";import"../chunks/Dx_ZiApV.js";import{p as Zs}from"../chunks/OhDFNrVl.js";import"../chunks/B-bm3bX7.js";const bi=!0,wi=!0,wu=Object.freeze(Object.defineProperty({__proto__:null,prerender:bi,ssr:wi},Symbol.toStringTag,{value:"Module"}));function xi(r,e){e(!e())}var ki=Se('<i class="bx bx-check"></i>'),Si=Se('<i class="bx bxs-circle text-gray-300"></i>'),Ai=Se('<sl-button><div class="flex"><div class="my-auto mr-4 text-3xl"><!></div> <p class="my-auto text-base text-wrap"> </p></div></sl-button>',2);function Ci(r,e){let t=Zs(e,"isChecked",15,!1);var n=Ai();n.__click=[xi,t],ae(n,"class","checkable-message instrument-sans my-2 w-full px-2 text-sm text-white svelte-3qwgp8");var s=J(n),a=J(s),i=J(a);{var o=d=>{var m=ki();le(d,m)},c=d=>{var m=Si();le(d,m)};$t(i,d=>{t()?d(o):d(c,!1)})}z(a);var l=Ve(a,2),u=J(l,!0);z(l),z(s),z(n),Ze(()=>pt(u,e.content)),le(r,n)}Rr(["click"]);const Pi=[{label:"❤️  Health",name:"health"},{label:"🔥  Fire Outbreak",name:"fire"},{label:"🚨  Break In",name:"breakin"},{label:"🦗  Stranded",name:"stranded"}],Ds=()=>Pi;var N;(function(r){r.assertEqual=s=>s;function e(s){}r.assertIs=e;function t(s){throw new Error}r.assertNever=t,r.arrayToEnum=s=>{const a={};for(const i of s)a[i]=i;return a},r.getValidEnumValues=s=>{const a=r.objectKeys(s).filter(o=>typeof s[s[o]]!="number"),i={};for(const o of a)i[o]=s[o];return r.objectValues(i)},r.objectValues=s=>r.objectKeys(s).map(function(a){return s[a]}),r.objectKeys=typeof Object.keys=="function"?s=>Object.keys(s):s=>{const a=[];for(const i in s)Object.prototype.hasOwnProperty.call(s,i)&&a.push(i);return a},r.find=(s,a)=>{for(const i of s)if(a(i))return i},r.isInteger=typeof Number.isInteger=="function"?s=>Number.isInteger(s):s=>typeof s=="number"&&isFinite(s)&&Math.floor(s)===s;function n(s,a=" | "){return s.map(i=>typeof i=="string"?`'${i}'`:i).join(a)}r.joinValues=n,r.jsonStringifyReplacer=(s,a)=>typeof a=="bigint"?a.toString():a})(N||(N={}));var ur;(function(r){r.mergeShapes=(e,t)=>({...e,...t})})(ur||(ur={}));const v=N.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),De=r=>{switch(typeof r){case"undefined":return v.undefined;case"string":return v.string;case"number":return isNaN(r)?v.nan:v.number;case"boolean":return v.boolean;case"function":return v.function;case"bigint":return v.bigint;case"symbol":return v.symbol;case"object":return Array.isArray(r)?v.array:r===null?v.null:r.then&&typeof r.then=="function"&&r.catch&&typeof r.catch=="function"?v.promise:typeof Map<"u"&&r instanceof Map?v.map:typeof Set<"u"&&r instanceof Set?v.set:typeof Date<"u"&&r instanceof Date?v.date:v.object;default:return v.unknown}},f=N.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),Ei=r=>JSON.stringify(r,null,2).replace(/"([^"]+)":/g,"$1:");class ue extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};const t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}format(e){const t=e||function(a){return a.message},n={_errors:[]},s=a=>{for(const i of a.issues)if(i.code==="invalid_union")i.unionErrors.map(s);else if(i.code==="invalid_return_type")s(i.returnTypeError);else if(i.code==="invalid_arguments")s(i.argumentsError);else if(i.path.length===0)n._errors.push(t(i));else{let o=n,c=0;for(;c<i.path.length;){const l=i.path[c];c===i.path.length-1?(o[l]=o[l]||{_errors:[]},o[l]._errors.push(t(i))):o[l]=o[l]||{_errors:[]},o=o[l],c++}}};return s(this),n}static assert(e){if(!(e instanceof ue))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,N.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=t=>t.message){const t={},n=[];for(const s of this.issues)s.path.length>0?(t[s.path[0]]=t[s.path[0]]||[],t[s.path[0]].push(e(s))):n.push(e(s));return{formErrors:n,fieldErrors:t}}get formErrors(){return this.flatten()}}ue.create=r=>new ue(r);const kt=(r,e)=>{let t;switch(r.code){case f.invalid_type:r.received===v.undefined?t="Required":t=`Expected ${r.expected}, received ${r.received}`;break;case f.invalid_literal:t=`Invalid literal value, expected ${JSON.stringify(r.expected,N.jsonStringifyReplacer)}`;break;case f.unrecognized_keys:t=`Unrecognized key(s) in object: ${N.joinValues(r.keys,", ")}`;break;case f.invalid_union:t="Invalid input";break;case f.invalid_union_discriminator:t=`Invalid discriminator value. Expected ${N.joinValues(r.options)}`;break;case f.invalid_enum_value:t=`Invalid enum value. Expected ${N.joinValues(r.options)}, received '${r.received}'`;break;case f.invalid_arguments:t="Invalid function arguments";break;case f.invalid_return_type:t="Invalid function return type";break;case f.invalid_date:t="Invalid date";break;case f.invalid_string:typeof r.validation=="object"?"includes"in r.validation?(t=`Invalid input: must include "${r.validation.includes}"`,typeof r.validation.position=="number"&&(t=`${t} at one or more positions greater than or equal to ${r.validation.position}`)):"startsWith"in r.validation?t=`Invalid input: must start with "${r.validation.startsWith}"`:"endsWith"in r.validation?t=`Invalid input: must end with "${r.validation.endsWith}"`:N.assertNever(r.validation):r.validation!=="regex"?t=`Invalid ${r.validation}`:t="Invalid";break;case f.too_small:r.type==="array"?t=`Array must contain ${r.exact?"exactly":r.inclusive?"at least":"more than"} ${r.minimum} element(s)`:r.type==="string"?t=`String must contain ${r.exact?"exactly":r.inclusive?"at least":"over"} ${r.minimum} character(s)`:r.type==="number"?t=`Number must be ${r.exact?"exactly equal to ":r.inclusive?"greater than or equal to ":"greater than "}${r.minimum}`:r.type==="date"?t=`Date must be ${r.exact?"exactly equal to ":r.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(r.minimum))}`:t="Invalid input";break;case f.too_big:r.type==="array"?t=`Array must contain ${r.exact?"exactly":r.inclusive?"at most":"less than"} ${r.maximum} element(s)`:r.type==="string"?t=`String must contain ${r.exact?"exactly":r.inclusive?"at most":"under"} ${r.maximum} character(s)`:r.type==="number"?t=`Number must be ${r.exact?"exactly":r.inclusive?"less than or equal to":"less than"} ${r.maximum}`:r.type==="bigint"?t=`BigInt must be ${r.exact?"exactly":r.inclusive?"less than or equal to":"less than"} ${r.maximum}`:r.type==="date"?t=`Date must be ${r.exact?"exactly":r.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(r.maximum))}`:t="Invalid input";break;case f.custom:t="Invalid input";break;case f.invalid_intersection_types:t="Intersection results could not be merged";break;case f.not_multiple_of:t=`Number must be a multiple of ${r.multipleOf}`;break;case f.not_finite:t="Number must be finite";break;default:t=e.defaultError,N.assertNever(r)}return{message:t}};let Fs=kt;function Ri(r){Fs=r}function En(){return Fs}const Rn=r=>{const{data:e,path:t,errorMaps:n,issueData:s}=r,a=[...t,...s.path||[]],i={...s,path:a};if(s.message!==void 0)return{...s,path:a,message:s.message};let o="";const c=n.filter(l=>!!l).slice().reverse();for(const l of c)o=l(i,{data:e,defaultError:o}).message;return{...s,path:a,message:o}},Ti=[];function p(r,e){const t=En(),n=Rn({issueData:e,data:r.data,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,t,t===kt?void 0:kt].filter(s=>!!s)});r.common.issues.push(n)}class ee{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,t){const n=[];for(const s of t){if(s.status==="aborted")return A;s.status==="dirty"&&e.dirty(),n.push(s.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,t){const n=[];for(const s of t){const a=await s.key,i=await s.value;n.push({key:a,value:i})}return ee.mergeObjectSync(e,n)}static mergeObjectSync(e,t){const n={};for(const s of t){const{key:a,value:i}=s;if(a.status==="aborted"||i.status==="aborted")return A;a.status==="dirty"&&e.dirty(),i.status==="dirty"&&e.dirty(),a.value!=="__proto__"&&(typeof i.value<"u"||s.alwaysSet)&&(n[a.value]=i.value)}return{status:e.value,value:n}}}const A=Object.freeze({status:"aborted"}),gt=r=>({status:"dirty",value:r}),te=r=>({status:"valid",value:r}),dr=r=>r.status==="aborted",fr=r=>r.status==="dirty",nt=r=>r.status==="valid",qt=r=>typeof Promise<"u"&&r instanceof Promise;function Tn(r,e,t,n){if(typeof e=="function"?r!==e||!0:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return e.get(r)}function Ls(r,e,t,n,s){if(typeof e=="function"?r!==e||!0:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(r,t),t}var w;(function(r){r.errToObj=e=>typeof e=="string"?{message:e}:e||{},r.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(w||(w={}));var Nt,Mt;class Oe{constructor(e,t,n,s){this._cachedPath=[],this.parent=e,this.data=t,this._path=n,this._key=s}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const is=(r,e)=>{if(nt(e))return{success:!0,data:e.value};if(!r.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const t=new ue(r.common.issues);return this._error=t,this._error}}};function C(r){if(!r)return{};const{errorMap:e,invalid_type_error:t,required_error:n,description:s}=r;if(e&&(t||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:s}:{errorMap:(i,o)=>{var c,l;const{message:u}=r;return i.code==="invalid_enum_value"?{message:u??o.defaultError}:typeof o.data>"u"?{message:(c=u??n)!==null&&c!==void 0?c:o.defaultError}:i.code!=="invalid_type"?{message:o.defaultError}:{message:(l=u??t)!==null&&l!==void 0?l:o.defaultError}},description:s}}class E{get description(){return this._def.description}_getType(e){return De(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:De(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new ee,ctx:{common:e.parent.common,data:e.data,parsedType:De(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if(qt(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const n=this.safeParse(e,t);if(n.success)return n.data;throw n.error}safeParse(e,t){var n;const s={common:{issues:[],async:(n=t==null?void 0:t.async)!==null&&n!==void 0?n:!1,contextualErrorMap:t==null?void 0:t.errorMap},path:(t==null?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:De(e)},a=this._parseSync({data:e,path:s.path,parent:s});return is(s,a)}"~validate"(e){var t,n;const s={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:De(e)};if(!this["~standard"].async)try{const a=this._parseSync({data:e,path:[],parent:s});return nt(a)?{value:a.value}:{issues:s.common.issues}}catch(a){!((n=(t=a==null?void 0:a.message)===null||t===void 0?void 0:t.toLowerCase())===null||n===void 0)&&n.includes("encountered")&&(this["~standard"].async=!0),s.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:s}).then(a=>nt(a)?{value:a.value}:{issues:s.common.issues})}async parseAsync(e,t){const n=await this.safeParseAsync(e,t);if(n.success)return n.data;throw n.error}async safeParseAsync(e,t){const n={common:{issues:[],contextualErrorMap:t==null?void 0:t.errorMap,async:!0},path:(t==null?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:De(e)},s=this._parse({data:e,path:n.path,parent:n}),a=await(qt(s)?s:Promise.resolve(s));return is(n,a)}refine(e,t){const n=s=>typeof t=="string"||typeof t>"u"?{message:t}:typeof t=="function"?t(s):t;return this._refinement((s,a)=>{const i=e(s),o=()=>a.addIssue({code:f.custom,...n(s)});return typeof Promise<"u"&&i instanceof Promise?i.then(c=>c?!0:(o(),!1)):i?!0:(o(),!1)})}refinement(e,t){return this._refinement((n,s)=>e(n)?!0:(s.addIssue(typeof t=="function"?t(n,s):t),!1))}_refinement(e){return new ke({schema:this,typeName:h.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:t=>this["~validate"](t)}}optional(){return Te.create(this,this._def)}nullable(){return He.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return xe.create(this)}promise(){return At.create(this,this._def)}or(e){return Ht.create([this,e],this._def)}and(e){return Xt.create(this,e,this._def)}transform(e){return new ke({...C(this._def),schema:this,typeName:h.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t=typeof e=="function"?e:()=>e;return new en({...C(this._def),innerType:this,defaultValue:t,typeName:h.ZodDefault})}brand(){return new Tr({typeName:h.ZodBranded,type:this,...C(this._def)})}catch(e){const t=typeof e=="function"?e:()=>e;return new tn({...C(this._def),innerType:this,catchValue:t,typeName:h.ZodCatch})}describe(e){const t=this.constructor;return new t({...this._def,description:e})}pipe(e){return on.create(this,e)}readonly(){return nn.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const Oi=/^c[^\s-]{8,}$/i,Ii=/^[0-9a-z]+$/,$i=/^[0-9A-HJKMNP-TV-Z]{26}$/i,Ni=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,Mi=/^[a-z0-9_-]{21}$/i,ji=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,Zi=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,Di=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,Fi="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let Kn;const Li=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Bi=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,Ui=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,Vi=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,qi=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,zi=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,Bs="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",Wi=new RegExp(`^${Bs}$`);function Us(r){let e="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return r.precision?e=`${e}\\.\\d{${r.precision}}`:r.precision==null&&(e=`${e}(\\.\\d+)?`),e}function Ji(r){return new RegExp(`^${Us(r)}$`)}function Vs(r){let e=`${Bs}T${Us(r)}`;const t=[];return t.push(r.local?"Z?":"Z"),r.offset&&t.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${t.join("|")})`,new RegExp(`^${e}$`)}function Hi(r,e){return!!((e==="v4"||!e)&&Li.test(r)||(e==="v6"||!e)&&Ui.test(r))}function Xi(r,e){if(!ji.test(r))return!1;try{const[t]=r.split("."),n=t.replace(/-/g,"+").replace(/_/g,"/").padEnd(t.length+(4-t.length%4)%4,"="),s=JSON.parse(atob(n));return!(typeof s!="object"||s===null||!s.typ||!s.alg||e&&s.alg!==e)}catch{return!1}}function Ki(r,e){return!!((e==="v4"||!e)&&Bi.test(r)||(e==="v6"||!e)&&Vi.test(r))}class ve extends E{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==v.string){const a=this._getOrReturnCtx(e);return p(a,{code:f.invalid_type,expected:v.string,received:a.parsedType}),A}const n=new ee;let s;for(const a of this._def.checks)if(a.kind==="min")e.data.length<a.value&&(s=this._getOrReturnCtx(e,s),p(s,{code:f.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),n.dirty());else if(a.kind==="max")e.data.length>a.value&&(s=this._getOrReturnCtx(e,s),p(s,{code:f.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),n.dirty());else if(a.kind==="length"){const i=e.data.length>a.value,o=e.data.length<a.value;(i||o)&&(s=this._getOrReturnCtx(e,s),i?p(s,{code:f.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}):o&&p(s,{code:f.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}),n.dirty())}else if(a.kind==="email")Di.test(e.data)||(s=this._getOrReturnCtx(e,s),p(s,{validation:"email",code:f.invalid_string,message:a.message}),n.dirty());else if(a.kind==="emoji")Kn||(Kn=new RegExp(Fi,"u")),Kn.test(e.data)||(s=this._getOrReturnCtx(e,s),p(s,{validation:"emoji",code:f.invalid_string,message:a.message}),n.dirty());else if(a.kind==="uuid")Ni.test(e.data)||(s=this._getOrReturnCtx(e,s),p(s,{validation:"uuid",code:f.invalid_string,message:a.message}),n.dirty());else if(a.kind==="nanoid")Mi.test(e.data)||(s=this._getOrReturnCtx(e,s),p(s,{validation:"nanoid",code:f.invalid_string,message:a.message}),n.dirty());else if(a.kind==="cuid")Oi.test(e.data)||(s=this._getOrReturnCtx(e,s),p(s,{validation:"cuid",code:f.invalid_string,message:a.message}),n.dirty());else if(a.kind==="cuid2")Ii.test(e.data)||(s=this._getOrReturnCtx(e,s),p(s,{validation:"cuid2",code:f.invalid_string,message:a.message}),n.dirty());else if(a.kind==="ulid")$i.test(e.data)||(s=this._getOrReturnCtx(e,s),p(s,{validation:"ulid",code:f.invalid_string,message:a.message}),n.dirty());else if(a.kind==="url")try{new URL(e.data)}catch{s=this._getOrReturnCtx(e,s),p(s,{validation:"url",code:f.invalid_string,message:a.message}),n.dirty()}else a.kind==="regex"?(a.regex.lastIndex=0,a.regex.test(e.data)||(s=this._getOrReturnCtx(e,s),p(s,{validation:"regex",code:f.invalid_string,message:a.message}),n.dirty())):a.kind==="trim"?e.data=e.data.trim():a.kind==="includes"?e.data.includes(a.value,a.position)||(s=this._getOrReturnCtx(e,s),p(s,{code:f.invalid_string,validation:{includes:a.value,position:a.position},message:a.message}),n.dirty()):a.kind==="toLowerCase"?e.data=e.data.toLowerCase():a.kind==="toUpperCase"?e.data=e.data.toUpperCase():a.kind==="startsWith"?e.data.startsWith(a.value)||(s=this._getOrReturnCtx(e,s),p(s,{code:f.invalid_string,validation:{startsWith:a.value},message:a.message}),n.dirty()):a.kind==="endsWith"?e.data.endsWith(a.value)||(s=this._getOrReturnCtx(e,s),p(s,{code:f.invalid_string,validation:{endsWith:a.value},message:a.message}),n.dirty()):a.kind==="datetime"?Vs(a).test(e.data)||(s=this._getOrReturnCtx(e,s),p(s,{code:f.invalid_string,validation:"datetime",message:a.message}),n.dirty()):a.kind==="date"?Wi.test(e.data)||(s=this._getOrReturnCtx(e,s),p(s,{code:f.invalid_string,validation:"date",message:a.message}),n.dirty()):a.kind==="time"?Ji(a).test(e.data)||(s=this._getOrReturnCtx(e,s),p(s,{code:f.invalid_string,validation:"time",message:a.message}),n.dirty()):a.kind==="duration"?Zi.test(e.data)||(s=this._getOrReturnCtx(e,s),p(s,{validation:"duration",code:f.invalid_string,message:a.message}),n.dirty()):a.kind==="ip"?Hi(e.data,a.version)||(s=this._getOrReturnCtx(e,s),p(s,{validation:"ip",code:f.invalid_string,message:a.message}),n.dirty()):a.kind==="jwt"?Xi(e.data,a.alg)||(s=this._getOrReturnCtx(e,s),p(s,{validation:"jwt",code:f.invalid_string,message:a.message}),n.dirty()):a.kind==="cidr"?Ki(e.data,a.version)||(s=this._getOrReturnCtx(e,s),p(s,{validation:"cidr",code:f.invalid_string,message:a.message}),n.dirty()):a.kind==="base64"?qi.test(e.data)||(s=this._getOrReturnCtx(e,s),p(s,{validation:"base64",code:f.invalid_string,message:a.message}),n.dirty()):a.kind==="base64url"?zi.test(e.data)||(s=this._getOrReturnCtx(e,s),p(s,{validation:"base64url",code:f.invalid_string,message:a.message}),n.dirty()):N.assertNever(a);return{status:n.value,value:e.data}}_regex(e,t,n){return this.refinement(s=>e.test(s),{validation:t,code:f.invalid_string,...w.errToObj(n)})}_addCheck(e){return new ve({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...w.errToObj(e)})}url(e){return this._addCheck({kind:"url",...w.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...w.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...w.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...w.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...w.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...w.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...w.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...w.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...w.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...w.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...w.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...w.errToObj(e)})}datetime(e){var t,n;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(t=e==null?void 0:e.offset)!==null&&t!==void 0?t:!1,local:(n=e==null?void 0:e.local)!==null&&n!==void 0?n:!1,...w.errToObj(e==null?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,...w.errToObj(e==null?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...w.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...w.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:t==null?void 0:t.position,...w.errToObj(t==null?void 0:t.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...w.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...w.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...w.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...w.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...w.errToObj(t)})}nonempty(e){return this.min(1,w.errToObj(e))}trim(){return new ve({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new ve({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new ve({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}ve.create=r=>{var e;return new ve({checks:[],typeName:h.ZodString,coerce:(e=r==null?void 0:r.coerce)!==null&&e!==void 0?e:!1,...C(r)})};function Gi(r,e){const t=(r.toString().split(".")[1]||"").length,n=(e.toString().split(".")[1]||"").length,s=t>n?t:n,a=parseInt(r.toFixed(s).replace(".","")),i=parseInt(e.toFixed(s).replace(".",""));return a%i/Math.pow(10,s)}class ze extends E{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==v.number){const a=this._getOrReturnCtx(e);return p(a,{code:f.invalid_type,expected:v.number,received:a.parsedType}),A}let n;const s=new ee;for(const a of this._def.checks)a.kind==="int"?N.isInteger(e.data)||(n=this._getOrReturnCtx(e,n),p(n,{code:f.invalid_type,expected:"integer",received:"float",message:a.message}),s.dirty()):a.kind==="min"?(a.inclusive?e.data<a.value:e.data<=a.value)&&(n=this._getOrReturnCtx(e,n),p(n,{code:f.too_small,minimum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),s.dirty()):a.kind==="max"?(a.inclusive?e.data>a.value:e.data>=a.value)&&(n=this._getOrReturnCtx(e,n),p(n,{code:f.too_big,maximum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),s.dirty()):a.kind==="multipleOf"?Gi(e.data,a.value)!==0&&(n=this._getOrReturnCtx(e,n),p(n,{code:f.not_multiple_of,multipleOf:a.value,message:a.message}),s.dirty()):a.kind==="finite"?Number.isFinite(e.data)||(n=this._getOrReturnCtx(e,n),p(n,{code:f.not_finite,message:a.message}),s.dirty()):N.assertNever(a);return{status:s.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,w.toString(t))}gt(e,t){return this.setLimit("min",e,!1,w.toString(t))}lte(e,t){return this.setLimit("max",e,!0,w.toString(t))}lt(e,t){return this.setLimit("max",e,!1,w.toString(t))}setLimit(e,t,n,s){return new ze({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:w.toString(s)}]})}_addCheck(e){return new ze({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:w.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:w.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:w.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:w.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:w.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:w.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:w.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:w.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:w.toString(e)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&N.isInteger(e.value))}get isFinite(){let e=null,t=null;for(const n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(t===null||n.value>t)&&(t=n.value):n.kind==="max"&&(e===null||n.value<e)&&(e=n.value)}return Number.isFinite(t)&&Number.isFinite(e)}}ze.create=r=>new ze({checks:[],typeName:h.ZodNumber,coerce:(r==null?void 0:r.coerce)||!1,...C(r)});class We extends E{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==v.bigint)return this._getInvalidInput(e);let n;const s=new ee;for(const a of this._def.checks)a.kind==="min"?(a.inclusive?e.data<a.value:e.data<=a.value)&&(n=this._getOrReturnCtx(e,n),p(n,{code:f.too_small,type:"bigint",minimum:a.value,inclusive:a.inclusive,message:a.message}),s.dirty()):a.kind==="max"?(a.inclusive?e.data>a.value:e.data>=a.value)&&(n=this._getOrReturnCtx(e,n),p(n,{code:f.too_big,type:"bigint",maximum:a.value,inclusive:a.inclusive,message:a.message}),s.dirty()):a.kind==="multipleOf"?e.data%a.value!==BigInt(0)&&(n=this._getOrReturnCtx(e,n),p(n,{code:f.not_multiple_of,multipleOf:a.value,message:a.message}),s.dirty()):N.assertNever(a);return{status:s.value,value:e.data}}_getInvalidInput(e){const t=this._getOrReturnCtx(e);return p(t,{code:f.invalid_type,expected:v.bigint,received:t.parsedType}),A}gte(e,t){return this.setLimit("min",e,!0,w.toString(t))}gt(e,t){return this.setLimit("min",e,!1,w.toString(t))}lte(e,t){return this.setLimit("max",e,!0,w.toString(t))}lt(e,t){return this.setLimit("max",e,!1,w.toString(t))}setLimit(e,t,n,s){return new We({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:w.toString(s)}]})}_addCheck(e){return new We({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:w.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:w.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:w.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:w.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:w.toString(t)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}We.create=r=>{var e;return new We({checks:[],typeName:h.ZodBigInt,coerce:(e=r==null?void 0:r.coerce)!==null&&e!==void 0?e:!1,...C(r)})};class zt extends E{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==v.boolean){const n=this._getOrReturnCtx(e);return p(n,{code:f.invalid_type,expected:v.boolean,received:n.parsedType}),A}return te(e.data)}}zt.create=r=>new zt({typeName:h.ZodBoolean,coerce:(r==null?void 0:r.coerce)||!1,...C(r)});class rt extends E{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==v.date){const a=this._getOrReturnCtx(e);return p(a,{code:f.invalid_type,expected:v.date,received:a.parsedType}),A}if(isNaN(e.data.getTime())){const a=this._getOrReturnCtx(e);return p(a,{code:f.invalid_date}),A}const n=new ee;let s;for(const a of this._def.checks)a.kind==="min"?e.data.getTime()<a.value&&(s=this._getOrReturnCtx(e,s),p(s,{code:f.too_small,message:a.message,inclusive:!0,exact:!1,minimum:a.value,type:"date"}),n.dirty()):a.kind==="max"?e.data.getTime()>a.value&&(s=this._getOrReturnCtx(e,s),p(s,{code:f.too_big,message:a.message,inclusive:!0,exact:!1,maximum:a.value,type:"date"}),n.dirty()):N.assertNever(a);return{status:n.value,value:new Date(e.data.getTime())}}_addCheck(e){return new rt({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:w.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:w.toString(t)})}get minDate(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e!=null?new Date(e):null}}rt.create=r=>new rt({checks:[],coerce:(r==null?void 0:r.coerce)||!1,typeName:h.ZodDate,...C(r)});class On extends E{_parse(e){if(this._getType(e)!==v.symbol){const n=this._getOrReturnCtx(e);return p(n,{code:f.invalid_type,expected:v.symbol,received:n.parsedType}),A}return te(e.data)}}On.create=r=>new On({typeName:h.ZodSymbol,...C(r)});class Wt extends E{_parse(e){if(this._getType(e)!==v.undefined){const n=this._getOrReturnCtx(e);return p(n,{code:f.invalid_type,expected:v.undefined,received:n.parsedType}),A}return te(e.data)}}Wt.create=r=>new Wt({typeName:h.ZodUndefined,...C(r)});class Jt extends E{_parse(e){if(this._getType(e)!==v.null){const n=this._getOrReturnCtx(e);return p(n,{code:f.invalid_type,expected:v.null,received:n.parsedType}),A}return te(e.data)}}Jt.create=r=>new Jt({typeName:h.ZodNull,...C(r)});class St extends E{constructor(){super(...arguments),this._any=!0}_parse(e){return te(e.data)}}St.create=r=>new St({typeName:h.ZodAny,...C(r)});class tt extends E{constructor(){super(...arguments),this._unknown=!0}_parse(e){return te(e.data)}}tt.create=r=>new tt({typeName:h.ZodUnknown,...C(r)});class Le extends E{_parse(e){const t=this._getOrReturnCtx(e);return p(t,{code:f.invalid_type,expected:v.never,received:t.parsedType}),A}}Le.create=r=>new Le({typeName:h.ZodNever,...C(r)});class In extends E{_parse(e){if(this._getType(e)!==v.undefined){const n=this._getOrReturnCtx(e);return p(n,{code:f.invalid_type,expected:v.void,received:n.parsedType}),A}return te(e.data)}}In.create=r=>new In({typeName:h.ZodVoid,...C(r)});class xe extends E{_parse(e){const{ctx:t,status:n}=this._processInputParams(e),s=this._def;if(t.parsedType!==v.array)return p(t,{code:f.invalid_type,expected:v.array,received:t.parsedType}),A;if(s.exactLength!==null){const i=t.data.length>s.exactLength.value,o=t.data.length<s.exactLength.value;(i||o)&&(p(t,{code:i?f.too_big:f.too_small,minimum:o?s.exactLength.value:void 0,maximum:i?s.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:s.exactLength.message}),n.dirty())}if(s.minLength!==null&&t.data.length<s.minLength.value&&(p(t,{code:f.too_small,minimum:s.minLength.value,type:"array",inclusive:!0,exact:!1,message:s.minLength.message}),n.dirty()),s.maxLength!==null&&t.data.length>s.maxLength.value&&(p(t,{code:f.too_big,maximum:s.maxLength.value,type:"array",inclusive:!0,exact:!1,message:s.maxLength.message}),n.dirty()),t.common.async)return Promise.all([...t.data].map((i,o)=>s.type._parseAsync(new Oe(t,i,t.path,o)))).then(i=>ee.mergeArray(n,i));const a=[...t.data].map((i,o)=>s.type._parseSync(new Oe(t,i,t.path,o)));return ee.mergeArray(n,a)}get element(){return this._def.type}min(e,t){return new xe({...this._def,minLength:{value:e,message:w.toString(t)}})}max(e,t){return new xe({...this._def,maxLength:{value:e,message:w.toString(t)}})}length(e,t){return new xe({...this._def,exactLength:{value:e,message:w.toString(t)}})}nonempty(e){return this.min(1,e)}}xe.create=(r,e)=>new xe({type:r,minLength:null,maxLength:null,exactLength:null,typeName:h.ZodArray,...C(e)});function ft(r){if(r instanceof W){const e={};for(const t in r.shape){const n=r.shape[t];e[t]=Te.create(ft(n))}return new W({...r._def,shape:()=>e})}else return r instanceof xe?new xe({...r._def,type:ft(r.element)}):r instanceof Te?Te.create(ft(r.unwrap())):r instanceof He?He.create(ft(r.unwrap())):r instanceof Ie?Ie.create(r.items.map(e=>ft(e))):r}class W extends E{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),t=N.objectKeys(e);return this._cached={shape:e,keys:t}}_parse(e){if(this._getType(e)!==v.object){const l=this._getOrReturnCtx(e);return p(l,{code:f.invalid_type,expected:v.object,received:l.parsedType}),A}const{status:n,ctx:s}=this._processInputParams(e),{shape:a,keys:i}=this._getCached(),o=[];if(!(this._def.catchall instanceof Le&&this._def.unknownKeys==="strip"))for(const l in s.data)i.includes(l)||o.push(l);const c=[];for(const l of i){const u=a[l],d=s.data[l];c.push({key:{status:"valid",value:l},value:u._parse(new Oe(s,d,s.path,l)),alwaysSet:l in s.data})}if(this._def.catchall instanceof Le){const l=this._def.unknownKeys;if(l==="passthrough")for(const u of o)c.push({key:{status:"valid",value:u},value:{status:"valid",value:s.data[u]}});else if(l==="strict")o.length>0&&(p(s,{code:f.unrecognized_keys,keys:o}),n.dirty());else if(l!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const l=this._def.catchall;for(const u of o){const d=s.data[u];c.push({key:{status:"valid",value:u},value:l._parse(new Oe(s,d,s.path,u)),alwaysSet:u in s.data})}}return s.common.async?Promise.resolve().then(async()=>{const l=[];for(const u of c){const d=await u.key,m=await u.value;l.push({key:d,value:m,alwaysSet:u.alwaysSet})}return l}).then(l=>ee.mergeObjectSync(n,l)):ee.mergeObjectSync(n,c)}get shape(){return this._def.shape()}strict(e){return w.errToObj,new W({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(t,n)=>{var s,a,i,o;const c=(i=(a=(s=this._def).errorMap)===null||a===void 0?void 0:a.call(s,t,n).message)!==null&&i!==void 0?i:n.defaultError;return t.code==="unrecognized_keys"?{message:(o=w.errToObj(e).message)!==null&&o!==void 0?o:c}:{message:c}}}:{}})}strip(){return new W({...this._def,unknownKeys:"strip"})}passthrough(){return new W({...this._def,unknownKeys:"passthrough"})}extend(e){return new W({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new W({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:h.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new W({...this._def,catchall:e})}pick(e){const t={};return N.objectKeys(e).forEach(n=>{e[n]&&this.shape[n]&&(t[n]=this.shape[n])}),new W({...this._def,shape:()=>t})}omit(e){const t={};return N.objectKeys(this.shape).forEach(n=>{e[n]||(t[n]=this.shape[n])}),new W({...this._def,shape:()=>t})}deepPartial(){return ft(this)}partial(e){const t={};return N.objectKeys(this.shape).forEach(n=>{const s=this.shape[n];e&&!e[n]?t[n]=s:t[n]=s.optional()}),new W({...this._def,shape:()=>t})}required(e){const t={};return N.objectKeys(this.shape).forEach(n=>{if(e&&!e[n])t[n]=this.shape[n];else{let a=this.shape[n];for(;a instanceof Te;)a=a._def.innerType;t[n]=a}}),new W({...this._def,shape:()=>t})}keyof(){return qs(N.objectKeys(this.shape))}}W.create=(r,e)=>new W({shape:()=>r,unknownKeys:"strip",catchall:Le.create(),typeName:h.ZodObject,...C(e)});W.strictCreate=(r,e)=>new W({shape:()=>r,unknownKeys:"strict",catchall:Le.create(),typeName:h.ZodObject,...C(e)});W.lazycreate=(r,e)=>new W({shape:r,unknownKeys:"strip",catchall:Le.create(),typeName:h.ZodObject,...C(e)});class Ht extends E{_parse(e){const{ctx:t}=this._processInputParams(e),n=this._def.options;function s(a){for(const o of a)if(o.result.status==="valid")return o.result;for(const o of a)if(o.result.status==="dirty")return t.common.issues.push(...o.ctx.common.issues),o.result;const i=a.map(o=>new ue(o.ctx.common.issues));return p(t,{code:f.invalid_union,unionErrors:i}),A}if(t.common.async)return Promise.all(n.map(async a=>{const i={...t,common:{...t.common,issues:[]},parent:null};return{result:await a._parseAsync({data:t.data,path:t.path,parent:i}),ctx:i}})).then(s);{let a;const i=[];for(const c of n){const l={...t,common:{...t.common,issues:[]},parent:null},u=c._parseSync({data:t.data,path:t.path,parent:l});if(u.status==="valid")return u;u.status==="dirty"&&!a&&(a={result:u,ctx:l}),l.common.issues.length&&i.push(l.common.issues)}if(a)return t.common.issues.push(...a.ctx.common.issues),a.result;const o=i.map(c=>new ue(c));return p(t,{code:f.invalid_union,unionErrors:o}),A}}get options(){return this._def.options}}Ht.create=(r,e)=>new Ht({options:r,typeName:h.ZodUnion,...C(e)});const Me=r=>r instanceof Gt?Me(r.schema):r instanceof ke?Me(r.innerType()):r instanceof Qt?[r.value]:r instanceof Je?r.options:r instanceof Yt?N.objectValues(r.enum):r instanceof en?Me(r._def.innerType):r instanceof Wt?[void 0]:r instanceof Jt?[null]:r instanceof Te?[void 0,...Me(r.unwrap())]:r instanceof He?[null,...Me(r.unwrap())]:r instanceof Tr||r instanceof nn?Me(r.unwrap()):r instanceof tn?Me(r._def.innerType):[];class Ln extends E{_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==v.object)return p(t,{code:f.invalid_type,expected:v.object,received:t.parsedType}),A;const n=this.discriminator,s=t.data[n],a=this.optionsMap.get(s);return a?t.common.async?a._parseAsync({data:t.data,path:t.path,parent:t}):a._parseSync({data:t.data,path:t.path,parent:t}):(p(t,{code:f.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[n]}),A)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,n){const s=new Map;for(const a of t){const i=Me(a.shape[e]);if(!i.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const o of i){if(s.has(o))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(o)}`);s.set(o,a)}}return new Ln({typeName:h.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:s,...C(n)})}}function hr(r,e){const t=De(r),n=De(e);if(r===e)return{valid:!0,data:r};if(t===v.object&&n===v.object){const s=N.objectKeys(e),a=N.objectKeys(r).filter(o=>s.indexOf(o)!==-1),i={...r,...e};for(const o of a){const c=hr(r[o],e[o]);if(!c.valid)return{valid:!1};i[o]=c.data}return{valid:!0,data:i}}else if(t===v.array&&n===v.array){if(r.length!==e.length)return{valid:!1};const s=[];for(let a=0;a<r.length;a++){const i=r[a],o=e[a],c=hr(i,o);if(!c.valid)return{valid:!1};s.push(c.data)}return{valid:!0,data:s}}else return t===v.date&&n===v.date&&+r==+e?{valid:!0,data:r}:{valid:!1}}class Xt extends E{_parse(e){const{status:t,ctx:n}=this._processInputParams(e),s=(a,i)=>{if(dr(a)||dr(i))return A;const o=hr(a.value,i.value);return o.valid?((fr(a)||fr(i))&&t.dirty(),{status:t.value,value:o.data}):(p(n,{code:f.invalid_intersection_types}),A)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([a,i])=>s(a,i)):s(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}}Xt.create=(r,e,t)=>new Xt({left:r,right:e,typeName:h.ZodIntersection,...C(t)});class Ie extends E{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==v.array)return p(n,{code:f.invalid_type,expected:v.array,received:n.parsedType}),A;if(n.data.length<this._def.items.length)return p(n,{code:f.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),A;!this._def.rest&&n.data.length>this._def.items.length&&(p(n,{code:f.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());const a=[...n.data].map((i,o)=>{const c=this._def.items[o]||this._def.rest;return c?c._parse(new Oe(n,i,n.path,o)):null}).filter(i=>!!i);return n.common.async?Promise.all(a).then(i=>ee.mergeArray(t,i)):ee.mergeArray(t,a)}get items(){return this._def.items}rest(e){return new Ie({...this._def,rest:e})}}Ie.create=(r,e)=>{if(!Array.isArray(r))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Ie({items:r,typeName:h.ZodTuple,rest:null,...C(e)})};class Kt extends E{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==v.object)return p(n,{code:f.invalid_type,expected:v.object,received:n.parsedType}),A;const s=[],a=this._def.keyType,i=this._def.valueType;for(const o in n.data)s.push({key:a._parse(new Oe(n,o,n.path,o)),value:i._parse(new Oe(n,n.data[o],n.path,o)),alwaysSet:o in n.data});return n.common.async?ee.mergeObjectAsync(t,s):ee.mergeObjectSync(t,s)}get element(){return this._def.valueType}static create(e,t,n){return t instanceof E?new Kt({keyType:e,valueType:t,typeName:h.ZodRecord,...C(n)}):new Kt({keyType:ve.create(),valueType:e,typeName:h.ZodRecord,...C(t)})}}class $n extends E{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==v.map)return p(n,{code:f.invalid_type,expected:v.map,received:n.parsedType}),A;const s=this._def.keyType,a=this._def.valueType,i=[...n.data.entries()].map(([o,c],l)=>({key:s._parse(new Oe(n,o,n.path,[l,"key"])),value:a._parse(new Oe(n,c,n.path,[l,"value"]))}));if(n.common.async){const o=new Map;return Promise.resolve().then(async()=>{for(const c of i){const l=await c.key,u=await c.value;if(l.status==="aborted"||u.status==="aborted")return A;(l.status==="dirty"||u.status==="dirty")&&t.dirty(),o.set(l.value,u.value)}return{status:t.value,value:o}})}else{const o=new Map;for(const c of i){const l=c.key,u=c.value;if(l.status==="aborted"||u.status==="aborted")return A;(l.status==="dirty"||u.status==="dirty")&&t.dirty(),o.set(l.value,u.value)}return{status:t.value,value:o}}}}$n.create=(r,e,t)=>new $n({valueType:e,keyType:r,typeName:h.ZodMap,...C(t)});class st extends E{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==v.set)return p(n,{code:f.invalid_type,expected:v.set,received:n.parsedType}),A;const s=this._def;s.minSize!==null&&n.data.size<s.minSize.value&&(p(n,{code:f.too_small,minimum:s.minSize.value,type:"set",inclusive:!0,exact:!1,message:s.minSize.message}),t.dirty()),s.maxSize!==null&&n.data.size>s.maxSize.value&&(p(n,{code:f.too_big,maximum:s.maxSize.value,type:"set",inclusive:!0,exact:!1,message:s.maxSize.message}),t.dirty());const a=this._def.valueType;function i(c){const l=new Set;for(const u of c){if(u.status==="aborted")return A;u.status==="dirty"&&t.dirty(),l.add(u.value)}return{status:t.value,value:l}}const o=[...n.data.values()].map((c,l)=>a._parse(new Oe(n,c,n.path,l)));return n.common.async?Promise.all(o).then(c=>i(c)):i(o)}min(e,t){return new st({...this._def,minSize:{value:e,message:w.toString(t)}})}max(e,t){return new st({...this._def,maxSize:{value:e,message:w.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}st.create=(r,e)=>new st({valueType:r,minSize:null,maxSize:null,typeName:h.ZodSet,...C(e)});class _t extends E{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==v.function)return p(t,{code:f.invalid_type,expected:v.function,received:t.parsedType}),A;function n(o,c){return Rn({data:o,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,En(),kt].filter(l=>!!l),issueData:{code:f.invalid_arguments,argumentsError:c}})}function s(o,c){return Rn({data:o,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,En(),kt].filter(l=>!!l),issueData:{code:f.invalid_return_type,returnTypeError:c}})}const a={errorMap:t.common.contextualErrorMap},i=t.data;if(this._def.returns instanceof At){const o=this;return te(async function(...c){const l=new ue([]),u=await o._def.args.parseAsync(c,a).catch(_=>{throw l.addIssue(n(c,_)),l}),d=await Reflect.apply(i,this,u);return await o._def.returns._def.type.parseAsync(d,a).catch(_=>{throw l.addIssue(s(d,_)),l})})}else{const o=this;return te(function(...c){const l=o._def.args.safeParse(c,a);if(!l.success)throw new ue([n(c,l.error)]);const u=Reflect.apply(i,this,l.data),d=o._def.returns.safeParse(u,a);if(!d.success)throw new ue([s(u,d.error)]);return d.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new _t({...this._def,args:Ie.create(e).rest(tt.create())})}returns(e){return new _t({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,n){return new _t({args:e||Ie.create([]).rest(tt.create()),returns:t||tt.create(),typeName:h.ZodFunction,...C(n)})}}class Gt extends E{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}Gt.create=(r,e)=>new Gt({getter:r,typeName:h.ZodLazy,...C(e)});class Qt extends E{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return p(t,{received:t.data,code:f.invalid_literal,expected:this._def.value}),A}return{status:"valid",value:e.data}}get value(){return this._def.value}}Qt.create=(r,e)=>new Qt({value:r,typeName:h.ZodLiteral,...C(e)});function qs(r,e){return new Je({values:r,typeName:h.ZodEnum,...C(e)})}class Je extends E{constructor(){super(...arguments),Nt.set(this,void 0)}_parse(e){if(typeof e.data!="string"){const t=this._getOrReturnCtx(e),n=this._def.values;return p(t,{expected:N.joinValues(n),received:t.parsedType,code:f.invalid_type}),A}if(Tn(this,Nt)||Ls(this,Nt,new Set(this._def.values)),!Tn(this,Nt).has(e.data)){const t=this._getOrReturnCtx(e),n=this._def.values;return p(t,{received:t.data,code:f.invalid_enum_value,options:n}),A}return te(e.data)}get options(){return this._def.values}get enum(){const e={};for(const t of this._def.values)e[t]=t;return e}get Values(){const e={};for(const t of this._def.values)e[t]=t;return e}get Enum(){const e={};for(const t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return Je.create(e,{...this._def,...t})}exclude(e,t=this._def){return Je.create(this.options.filter(n=>!e.includes(n)),{...this._def,...t})}}Nt=new WeakMap;Je.create=qs;class Yt extends E{constructor(){super(...arguments),Mt.set(this,void 0)}_parse(e){const t=N.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(e);if(n.parsedType!==v.string&&n.parsedType!==v.number){const s=N.objectValues(t);return p(n,{expected:N.joinValues(s),received:n.parsedType,code:f.invalid_type}),A}if(Tn(this,Mt)||Ls(this,Mt,new Set(N.getValidEnumValues(this._def.values))),!Tn(this,Mt).has(e.data)){const s=N.objectValues(t);return p(n,{received:n.data,code:f.invalid_enum_value,options:s}),A}return te(e.data)}get enum(){return this._def.values}}Mt=new WeakMap;Yt.create=(r,e)=>new Yt({values:r,typeName:h.ZodNativeEnum,...C(e)});class At extends E{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==v.promise&&t.common.async===!1)return p(t,{code:f.invalid_type,expected:v.promise,received:t.parsedType}),A;const n=t.parsedType===v.promise?t.data:Promise.resolve(t.data);return te(n.then(s=>this._def.type.parseAsync(s,{path:t.path,errorMap:t.common.contextualErrorMap})))}}At.create=(r,e)=>new At({type:r,typeName:h.ZodPromise,...C(e)});class ke extends E{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===h.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:n}=this._processInputParams(e),s=this._def.effect||null,a={addIssue:i=>{p(n,i),i.fatal?t.abort():t.dirty()},get path(){return n.path}};if(a.addIssue=a.addIssue.bind(a),s.type==="preprocess"){const i=s.transform(n.data,a);if(n.common.async)return Promise.resolve(i).then(async o=>{if(t.value==="aborted")return A;const c=await this._def.schema._parseAsync({data:o,path:n.path,parent:n});return c.status==="aborted"?A:c.status==="dirty"||t.value==="dirty"?gt(c.value):c});{if(t.value==="aborted")return A;const o=this._def.schema._parseSync({data:i,path:n.path,parent:n});return o.status==="aborted"?A:o.status==="dirty"||t.value==="dirty"?gt(o.value):o}}if(s.type==="refinement"){const i=o=>{const c=s.refinement(o,a);if(n.common.async)return Promise.resolve(c);if(c instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return o};if(n.common.async===!1){const o=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return o.status==="aborted"?A:(o.status==="dirty"&&t.dirty(),i(o.value),{status:t.value,value:o.value})}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(o=>o.status==="aborted"?A:(o.status==="dirty"&&t.dirty(),i(o.value).then(()=>({status:t.value,value:o.value}))))}if(s.type==="transform")if(n.common.async===!1){const i=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!nt(i))return i;const o=s.transform(i.value,a);if(o instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:o}}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(i=>nt(i)?Promise.resolve(s.transform(i.value,a)).then(o=>({status:t.value,value:o})):i);N.assertNever(s)}}ke.create=(r,e,t)=>new ke({schema:r,typeName:h.ZodEffects,effect:e,...C(t)});ke.createWithPreprocess=(r,e,t)=>new ke({schema:e,effect:{type:"preprocess",transform:r},typeName:h.ZodEffects,...C(t)});class Te extends E{_parse(e){return this._getType(e)===v.undefined?te(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Te.create=(r,e)=>new Te({innerType:r,typeName:h.ZodOptional,...C(e)});class He extends E{_parse(e){return this._getType(e)===v.null?te(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}He.create=(r,e)=>new He({innerType:r,typeName:h.ZodNullable,...C(e)});class en extends E{_parse(e){const{ctx:t}=this._processInputParams(e);let n=t.data;return t.parsedType===v.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}en.create=(r,e)=>new en({innerType:r,typeName:h.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...C(e)});class tn extends E{_parse(e){const{ctx:t}=this._processInputParams(e),n={...t,common:{...t.common,issues:[]}},s=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return qt(s)?s.then(a=>({status:"valid",value:a.status==="valid"?a.value:this._def.catchValue({get error(){return new ue(n.common.issues)},input:n.data})})):{status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new ue(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}}tn.create=(r,e)=>new tn({innerType:r,typeName:h.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...C(e)});class Nn extends E{_parse(e){if(this._getType(e)!==v.nan){const n=this._getOrReturnCtx(e);return p(n,{code:f.invalid_type,expected:v.nan,received:n.parsedType}),A}return{status:"valid",value:e.data}}}Nn.create=r=>new Nn({typeName:h.ZodNaN,...C(r)});const Qi=Symbol("zod_brand");class Tr extends E{_parse(e){const{ctx:t}=this._processInputParams(e),n=t.data;return this._def.type._parse({data:n,path:t.path,parent:t})}unwrap(){return this._def.type}}class on extends E{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.common.async)return(async()=>{const a=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return a.status==="aborted"?A:a.status==="dirty"?(t.dirty(),gt(a.value)):this._def.out._parseAsync({data:a.value,path:n.path,parent:n})})();{const s=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return s.status==="aborted"?A:s.status==="dirty"?(t.dirty(),{status:"dirty",value:s.value}):this._def.out._parseSync({data:s.value,path:n.path,parent:n})}}static create(e,t){return new on({in:e,out:t,typeName:h.ZodPipeline})}}class nn extends E{_parse(e){const t=this._def.innerType._parse(e),n=s=>(nt(s)&&(s.value=Object.freeze(s.value)),s);return qt(t)?t.then(s=>n(s)):n(t)}unwrap(){return this._def.innerType}}nn.create=(r,e)=>new nn({innerType:r,typeName:h.ZodReadonly,...C(e)});function zs(r,e={},t){return r?St.create().superRefine((n,s)=>{var a,i;if(!r(n)){const o=typeof e=="function"?e(n):typeof e=="string"?{message:e}:e,c=(i=(a=o.fatal)!==null&&a!==void 0?a:t)!==null&&i!==void 0?i:!0,l=typeof o=="string"?{message:o}:o;s.addIssue({code:"custom",...l,fatal:c})}}):St.create()}const Yi={object:W.lazycreate};var h;(function(r){r.ZodString="ZodString",r.ZodNumber="ZodNumber",r.ZodNaN="ZodNaN",r.ZodBigInt="ZodBigInt",r.ZodBoolean="ZodBoolean",r.ZodDate="ZodDate",r.ZodSymbol="ZodSymbol",r.ZodUndefined="ZodUndefined",r.ZodNull="ZodNull",r.ZodAny="ZodAny",r.ZodUnknown="ZodUnknown",r.ZodNever="ZodNever",r.ZodVoid="ZodVoid",r.ZodArray="ZodArray",r.ZodObject="ZodObject",r.ZodUnion="ZodUnion",r.ZodDiscriminatedUnion="ZodDiscriminatedUnion",r.ZodIntersection="ZodIntersection",r.ZodTuple="ZodTuple",r.ZodRecord="ZodRecord",r.ZodMap="ZodMap",r.ZodSet="ZodSet",r.ZodFunction="ZodFunction",r.ZodLazy="ZodLazy",r.ZodLiteral="ZodLiteral",r.ZodEnum="ZodEnum",r.ZodEffects="ZodEffects",r.ZodNativeEnum="ZodNativeEnum",r.ZodOptional="ZodOptional",r.ZodNullable="ZodNullable",r.ZodDefault="ZodDefault",r.ZodCatch="ZodCatch",r.ZodPromise="ZodPromise",r.ZodBranded="ZodBranded",r.ZodPipeline="ZodPipeline",r.ZodReadonly="ZodReadonly"})(h||(h={}));const eo=(r,e={message:`Input not instance of ${r.name}`})=>zs(t=>t instanceof r,e),Ws=ve.create,Js=ze.create,to=Nn.create,no=We.create,Hs=zt.create,ro=rt.create,so=On.create,ao=Wt.create,io=Jt.create,oo=St.create,co=tt.create,lo=Le.create,uo=In.create,fo=xe.create,ho=W.create,mo=W.strictCreate,po=Ht.create,go=Ln.create,yo=Xt.create,_o=Ie.create,vo=Kt.create,bo=$n.create,wo=st.create,xo=_t.create,ko=Gt.create,So=Qt.create,Ao=Je.create,Co=Yt.create,Po=At.create,os=ke.create,Eo=Te.create,Ro=He.create,To=ke.createWithPreprocess,Oo=on.create,Io=()=>Ws().optional(),$o=()=>Js().optional(),No=()=>Hs().optional(),Mo={string:r=>ve.create({...r,coerce:!0}),number:r=>ze.create({...r,coerce:!0}),boolean:r=>zt.create({...r,coerce:!0}),bigint:r=>We.create({...r,coerce:!0}),date:r=>rt.create({...r,coerce:!0})},jo=A;var Fe=Object.freeze({__proto__:null,defaultErrorMap:kt,setErrorMap:Ri,getErrorMap:En,makeIssue:Rn,EMPTY_PATH:Ti,addIssueToContext:p,ParseStatus:ee,INVALID:A,DIRTY:gt,OK:te,isAborted:dr,isDirty:fr,isValid:nt,isAsync:qt,get util(){return N},get objectUtil(){return ur},ZodParsedType:v,getParsedType:De,ZodType:E,datetimeRegex:Vs,ZodString:ve,ZodNumber:ze,ZodBigInt:We,ZodBoolean:zt,ZodDate:rt,ZodSymbol:On,ZodUndefined:Wt,ZodNull:Jt,ZodAny:St,ZodUnknown:tt,ZodNever:Le,ZodVoid:In,ZodArray:xe,ZodObject:W,ZodUnion:Ht,ZodDiscriminatedUnion:Ln,ZodIntersection:Xt,ZodTuple:Ie,ZodRecord:Kt,ZodMap:$n,ZodSet:st,ZodFunction:_t,ZodLazy:Gt,ZodLiteral:Qt,ZodEnum:Je,ZodNativeEnum:Yt,ZodPromise:At,ZodEffects:ke,ZodTransformer:ke,ZodOptional:Te,ZodNullable:He,ZodDefault:en,ZodCatch:tn,ZodNaN:Nn,BRAND:Qi,ZodBranded:Tr,ZodPipeline:on,ZodReadonly:nn,custom:zs,Schema:E,ZodSchema:E,late:Yi,get ZodFirstPartyTypeKind(){return h},coerce:Mo,any:oo,array:fo,bigint:no,boolean:Hs,date:ro,discriminatedUnion:go,effect:os,enum:Ao,function:xo,instanceof:eo,intersection:yo,lazy:ko,literal:So,map:bo,nan:to,nativeEnum:Co,never:lo,null:io,nullable:Ro,number:Js,object:ho,oboolean:No,onumber:$o,optional:Eo,ostring:Io,pipeline:Oo,preprocess:To,promise:Po,record:vo,set:wo,strictObject:mo,string:Ws,symbol:so,transformer:os,tuple:_o,undefined:ao,union:po,unknown:co,void:uo,NEVER:jo,ZodIssueCode:f,quotelessJson:Ei,ZodError:ue});const mr="RFC3986",pr={RFC1738:r=>String(r).replace(/%20/g,"+"),RFC3986:r=>String(r)},Zo="RFC1738",Do=Array.isArray,Ce=(()=>{const r=[];for(let e=0;e<256;++e)r.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return r})(),Gn=1024,Fo=(r,e,t,n,s)=>{if(r.length===0)return r;let a=r;if(typeof r=="symbol"?a=Symbol.prototype.toString.call(r):typeof r!="string"&&(a=String(r)),t==="iso-8859-1")return escape(a).replace(/%u[0-9a-f]{4}/gi,function(o){return"%26%23"+parseInt(o.slice(2),16)+"%3B"});let i="";for(let o=0;o<a.length;o+=Gn){const c=a.length>=Gn?a.slice(o,o+Gn):a,l=[];for(let u=0;u<c.length;++u){let d=c.charCodeAt(u);if(d===45||d===46||d===95||d===126||d>=48&&d<=57||d>=65&&d<=90||d>=97&&d<=122||s===Zo&&(d===40||d===41)){l[l.length]=c.charAt(u);continue}if(d<128){l[l.length]=Ce[d];continue}if(d<2048){l[l.length]=Ce[192|d>>6]+Ce[128|d&63];continue}if(d<55296||d>=57344){l[l.length]=Ce[224|d>>12]+Ce[128|d>>6&63]+Ce[128|d&63];continue}u+=1,d=65536+((d&1023)<<10|c.charCodeAt(u)&1023),l[l.length]=Ce[240|d>>18]+Ce[128|d>>12&63]+Ce[128|d>>6&63]+Ce[128|d&63]}i+=l.join("")}return i};function Lo(r){return!r||typeof r!="object"?!1:!!(r.constructor&&r.constructor.isBuffer&&r.constructor.isBuffer(r))}function cs(r,e){if(Do(r)){const t=[];for(let n=0;n<r.length;n+=1)t.push(e(r[n]));return t}return e(r)}const Bo=Object.prototype.hasOwnProperty,Xs={brackets(r){return String(r)+"[]"},comma:"comma",indices(r,e){return String(r)+"["+e+"]"},repeat(r){return String(r)}},Pe=Array.isArray,Uo=Array.prototype.push,Ks=function(r,e){Uo.apply(r,Pe(e)?e:[e])},Vo=Date.prototype.toISOString,X={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:Fo,encodeValuesOnly:!1,format:mr,formatter:pr[mr],indices:!1,serializeDate(r){return Vo.call(r)},skipNulls:!1,strictNullHandling:!1};function qo(r){return typeof r=="string"||typeof r=="number"||typeof r=="boolean"||typeof r=="symbol"||typeof r=="bigint"}const Qn={};function Gs(r,e,t,n,s,a,i,o,c,l,u,d,m,_,S,g,b,$){let y=r,P=$,k=0,F=!1;for(;(P=P.get(Qn))!==void 0&&!F;){const B=P.get(r);if(k+=1,typeof B<"u"){if(B===k)throw new RangeError("Cyclic object value");F=!0}typeof P.get(Qn)>"u"&&(k=0)}if(typeof l=="function"?y=l(e,y):y instanceof Date?y=m==null?void 0:m(y):t==="comma"&&Pe(y)&&(y=cs(y,function(B){return B instanceof Date?m==null?void 0:m(B):B})),y===null){if(a)return c&&!g?c(e,X.encoder,b,"key",_):e;y=""}if(qo(y)||Lo(y)){if(c){const B=g?e:c(e,X.encoder,b,"key",_);return[(S==null?void 0:S(B))+"="+(S==null?void 0:S(c(y,X.encoder,b,"value",_)))]}return[(S==null?void 0:S(e))+"="+(S==null?void 0:S(String(y)))]}const T=[];if(typeof y>"u")return T;let R;if(t==="comma"&&Pe(y))g&&c&&(y=cs(y,c)),R=[{value:y.length>0?y.join(",")||null:void 0}];else if(Pe(l))R=l;else{const B=Object.keys(y);R=u?B.sort(u):B}const I=o?String(e).replace(/\./g,"%2E"):String(e),L=n&&Pe(y)&&y.length===1?I+"[]":I;if(s&&Pe(y)&&y.length===0)return L+"[]";for(let B=0;B<R.length;++B){const j=R[B],de=typeof j=="object"&&typeof j.value<"u"?j.value:y[j];if(i&&de===null)continue;const $e=d&&o?j.replace(/\./g,"%2E"):j,me=Pe(y)?typeof t=="function"?t(L,$e):L:L+(d?"."+$e:"["+$e+"]");$.set(r,k);const Be=new WeakMap;Be.set(Qn,$),Ks(T,Gs(de,me,t,n,s,a,i,o,t==="comma"&&g&&Pe(y)?null:c,l,u,d,m,_,S,g,b,Be))}return T}function zo(r=X){if(typeof r.allowEmptyArrays<"u"&&typeof r.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof r.encodeDotInKeys<"u"&&typeof r.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(r.encoder!==null&&typeof r.encoder<"u"&&typeof r.encoder!="function")throw new TypeError("Encoder has to be a function.");const e=r.charset||X.charset;if(typeof r.charset<"u"&&r.charset!=="utf-8"&&r.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let t=mr;if(typeof r.format<"u"){if(!Bo.call(pr,r.format))throw new TypeError("Unknown format option provided.");t=r.format}const n=pr[t];let s=X.filter;(typeof r.filter=="function"||Pe(r.filter))&&(s=r.filter);let a;if(r.arrayFormat&&r.arrayFormat in Xs?a=r.arrayFormat:"indices"in r?a=r.indices?"indices":"repeat":a=X.arrayFormat,"commaRoundTrip"in r&&typeof r.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");const i=typeof r.allowDots>"u"?r.encodeDotInKeys?!0:X.allowDots:!!r.allowDots;return{addQueryPrefix:typeof r.addQueryPrefix=="boolean"?r.addQueryPrefix:X.addQueryPrefix,allowDots:i,allowEmptyArrays:typeof r.allowEmptyArrays=="boolean"?!!r.allowEmptyArrays:X.allowEmptyArrays,arrayFormat:a,charset:e,charsetSentinel:typeof r.charsetSentinel=="boolean"?r.charsetSentinel:X.charsetSentinel,commaRoundTrip:!!r.commaRoundTrip,delimiter:typeof r.delimiter>"u"?X.delimiter:r.delimiter,encode:typeof r.encode=="boolean"?r.encode:X.encode,encodeDotInKeys:typeof r.encodeDotInKeys=="boolean"?r.encodeDotInKeys:X.encodeDotInKeys,encoder:typeof r.encoder=="function"?r.encoder:X.encoder,encodeValuesOnly:typeof r.encodeValuesOnly=="boolean"?r.encodeValuesOnly:X.encodeValuesOnly,filter:s,format:t,formatter:n,serializeDate:typeof r.serializeDate=="function"?r.serializeDate:X.serializeDate,skipNulls:typeof r.skipNulls=="boolean"?r.skipNulls:X.skipNulls,sort:typeof r.sort=="function"?r.sort:null,strictNullHandling:typeof r.strictNullHandling=="boolean"?r.strictNullHandling:X.strictNullHandling}}function Wo(r,e={}){let t=r;const n=zo(e);let s,a;typeof n.filter=="function"?(a=n.filter,t=a("",t)):Pe(n.filter)&&(a=n.filter,s=a);const i=[];if(typeof t!="object"||t===null)return"";const o=Xs[n.arrayFormat],c=o==="comma"&&n.commaRoundTrip;s||(s=Object.keys(t)),n.sort&&s.sort(n.sort);const l=new WeakMap;for(let m=0;m<s.length;++m){const _=s[m];n.skipNulls&&t[_]===null||Ks(i,Gs(t[_],_,o,c,n.allowEmptyArrays,n.strictNullHandling,n.skipNulls,n.encodeDotInKeys,n.encode?n.encoder:null,n.filter,n.sort,n.allowDots,n.serializeDate,n.format,n.formatter,n.encodeValuesOnly,n.charset,l))}const u=i.join(n.delimiter);let d=n.addQueryPrefix===!0?"?":"";return n.charsetSentinel&&(n.charset==="iso-8859-1"?d+="utf8=%26%2310003%3B&":d+="utf8=%E2%9C%93&"),u.length>0?d+u:""}const ht="4.82.0";let ls=!1,Ut,Qs,Ys,gr,ea,ta,na,ra,sa;function Jo(r,e={auto:!1}){if(ls)throw new Error(`you must \`import 'openai/shims/${r.kind}'\` before importing anything else from openai`);if(Ut)throw new Error(`can't \`import 'openai/shims/${r.kind}'\` after \`import 'openai/shims/${Ut}'\``);ls=e.auto,Ut=r.kind,Qs=r.fetch,Ys=r.FormData,gr=r.File,ea=r.ReadableStream,ta=r.getMultipartRequestOptions,na=r.getDefaultAgent,ra=r.fileFromPath,sa=r.isFsReadStream}class Ho{constructor(e){this.body=e}get[Symbol.toStringTag](){return"MultipartBody"}}function Xo({manuallyImported:r}={}){const e=r?"You may need to use polyfills":"Add one of these imports before your first `import … from 'openai'`:\n- `import 'openai/shims/node'` (if you're running on Node)\n- `import 'openai/shims/web'` (otherwise)\n";let t,n,s,a;try{t=fetch,n=Request,s=Response,a=Headers}catch(i){throw new Error(`this environment is missing the following Web Fetch API type: ${i.message}. ${e}`)}return{kind:"web",fetch:t,Request:n,Response:s,Headers:a,FormData:typeof FormData<"u"?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${e}`)}},Blob:typeof Blob<"u"?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${e}`)}},File:typeof File<"u"?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${e}`)}},ReadableStream:typeof ReadableStream<"u"?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${e}`)}},getMultipartRequestOptions:async(i,o)=>({...o,body:new Ho(i)}),getDefaultAgent:i=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/openai/openai-node#file-uploads")},isFsReadStream:i=>!1}}Ut||Jo(Xo(),{auto:!0});class O extends Error{}class Q extends O{constructor(e,t,n,s){super(`${Q.makeMessage(e,t,n)}`),this.status=e,this.headers=s,this.request_id=s==null?void 0:s["x-request-id"],this.error=t;const a=t;this.code=a==null?void 0:a.code,this.param=a==null?void 0:a.param,this.type=a==null?void 0:a.type}static makeMessage(e,t,n){const s=t!=null&&t.message?typeof t.message=="string"?t.message:JSON.stringify(t.message):t?JSON.stringify(t):n;return e&&s?`${e} ${s}`:e?`${e} status code (no body)`:s||"(no status code or body)"}static generate(e,t,n,s){if(!e||!s)return new Bn({message:n,cause:_r(t)});const a=t==null?void 0:t.error;return e===400?new aa(e,a,n,s):e===401?new ia(e,a,n,s):e===403?new oa(e,a,n,s):e===404?new ca(e,a,n,s):e===409?new la(e,a,n,s):e===422?new ua(e,a,n,s):e===429?new da(e,a,n,s):e>=500?new fa(e,a,n,s):new Q(e,a,n,s)}}class be extends Q{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class Bn extends Q{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),t&&(this.cause=t)}}class Or extends Bn{constructor({message:e}={}){super({message:e??"Request timed out."})}}class aa extends Q{}class ia extends Q{}class oa extends Q{}class ca extends Q{}class la extends Q{}class ua extends Q{}class da extends Q{}class fa extends Q{}class ha extends O{constructor(){super("Could not parse response content as the length limit was reached")}}class ma extends O{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}class at{constructor(){this.buffer=[],this.trailingCR=!1}decode(e){let t=this.decodeText(e);if(this.trailingCR&&(t="\r"+t,this.trailingCR=!1),t.endsWith("\r")&&(this.trailingCR=!0,t=t.slice(0,-1)),!t)return[];const n=at.NEWLINE_CHARS.has(t[t.length-1]||"");let s=t.split(at.NEWLINE_REGEXP);return n&&s.pop(),s.length===1&&!n?(this.buffer.push(s[0]),[]):(this.buffer.length>0&&(s=[this.buffer.join("")+s[0],...s.slice(1)],this.buffer=[]),n||(this.buffer=[s.pop()||""]),s)}decodeText(e){if(e==null)return"";if(typeof e=="string")return e;if(typeof Buffer<"u"){if(e instanceof Buffer)return e.toString();if(e instanceof Uint8Array)return Buffer.from(e).toString();throw new O(`Unexpected: received non-Uint8Array (${e.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if(typeof TextDecoder<"u"){if(e instanceof Uint8Array||e instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(e);throw new O(`Unexpected: received non-Uint8Array/ArrayBuffer (${e.constructor.name}) in a web platform. Please report this error.`)}throw new O("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){if(!this.buffer.length&&!this.trailingCR)return[];const e=[this.buffer.join("")];return this.buffer=[],this.trailingCR=!1,e}}at.NEWLINE_CHARS=new Set([`
`,"\r"]);at.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function pa(r){if(r[Symbol.asyncIterator])return r;const e=r.getReader();return{async next(){try{const t=await e.read();return t!=null&&t.done&&e.releaseLock(),t}catch(t){throw e.releaseLock(),t}},async return(){const t=e.cancel();return e.releaseLock(),await t,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}class Re{constructor(e,t){this.iterator=e,this.controller=t}static fromSSEResponse(e,t){let n=!1;async function*s(){if(n)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let a=!1;try{for await(const i of Ko(e,t))if(!a){if(i.data.startsWith("[DONE]")){a=!0;continue}if(i.event===null){let o;try{o=JSON.parse(i.data)}catch(c){throw console.error("Could not parse message into JSON:",i.data),console.error("From chunk:",i.raw),c}if(o&&o.error)throw new Q(void 0,o.error,void 0,void 0);yield o}else{let o;try{o=JSON.parse(i.data)}catch(c){throw console.error("Could not parse message into JSON:",i.data),console.error("From chunk:",i.raw),c}if(i.event=="error")throw new Q(void 0,o.error,o.message,void 0);yield{event:i.event,data:o}}}a=!0}catch(i){if(i instanceof Error&&i.name==="AbortError")return;throw i}finally{a||t.abort()}}return new Re(s,t)}static fromReadableStream(e,t){let n=!1;async function*s(){const i=new at,o=pa(e);for await(const c of o)for(const l of i.decode(c))yield l;for(const c of i.flush())yield c}async function*a(){if(n)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let i=!1;try{for await(const o of s())i||o&&(yield JSON.parse(o));i=!0}catch(o){if(o instanceof Error&&o.name==="AbortError")return;throw o}finally{i||t.abort()}}return new Re(a,t)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],t=[],n=this.iterator(),s=a=>({next:()=>{if(a.length===0){const i=n.next();e.push(i),t.push(i)}return a.shift()}});return[new Re(()=>s(e),this.controller),new Re(()=>s(t),this.controller)]}toReadableStream(){const e=this;let t;const n=new TextEncoder;return new ea({async start(){t=e[Symbol.asyncIterator]()},async pull(s){try{const{value:a,done:i}=await t.next();if(i)return s.close();const o=n.encode(JSON.stringify(a)+`
`);s.enqueue(o)}catch(a){s.error(a)}},async cancel(){var s;await((s=t.return)==null?void 0:s.call(t))}})}}async function*Ko(r,e){if(!r.body)throw e.abort(),new O("Attempted to iterate over a response with no body");const t=new Yo,n=new at,s=pa(r.body);for await(const a of Go(s))for(const i of n.decode(a)){const o=t.decode(i);o&&(yield o)}for(const a of n.flush()){const i=t.decode(a);i&&(yield i)}}async function*Go(r){let e=new Uint8Array;for await(const t of r){if(t==null)continue;const n=t instanceof ArrayBuffer?new Uint8Array(t):typeof t=="string"?new TextEncoder().encode(t):t;let s=new Uint8Array(e.length+n.length);s.set(e),s.set(n,e.length),e=s;let a;for(;(a=Qo(e))!==-1;)yield e.slice(0,a),e=e.slice(a)}e.length>0&&(yield e)}function Qo(r){for(let n=0;n<r.length-2;n++){if(r[n]===10&&r[n+1]===10||r[n]===13&&r[n+1]===13)return n+2;if(r[n]===13&&r[n+1]===10&&n+3<r.length&&r[n+2]===13&&r[n+3]===10)return n+4}return-1}class Yo{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const a={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],a}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,n,s]=ec(e,":");return s.startsWith(" ")&&(s=s.substring(1)),t==="event"?this.event=s:t==="data"&&this.data.push(s),null}}function ec(r,e){const t=r.indexOf(e);return t!==-1?[r.substring(0,t),e,r.substring(t+e.length)]:[r,"",""]}const ga=r=>r!=null&&typeof r=="object"&&typeof r.url=="string"&&typeof r.blob=="function",ya=r=>r!=null&&typeof r=="object"&&typeof r.name=="string"&&typeof r.lastModified=="number"&&Un(r),Un=r=>r!=null&&typeof r=="object"&&typeof r.size=="number"&&typeof r.type=="string"&&typeof r.text=="function"&&typeof r.slice=="function"&&typeof r.arrayBuffer=="function",tc=r=>ya(r)||ga(r)||sa(r);async function _a(r,e,t){var s;if(r=await r,ya(r))return r;if(ga(r)){const a=await r.blob();e||(e=new URL(r.url).pathname.split(/[\\/]/).pop()??"unknown_file");const i=Un(a)?[await a.arrayBuffer()]:[a];return new gr(i,e,t)}const n=await nc(r);if(e||(e=sc(r)??"unknown_file"),!(t!=null&&t.type)){const a=(s=n[0])==null?void 0:s.type;typeof a=="string"&&(t={...t,type:a})}return new gr(n,e,t)}async function nc(r){var t;let e=[];if(typeof r=="string"||ArrayBuffer.isView(r)||r instanceof ArrayBuffer)e.push(r);else if(Un(r))e.push(await r.arrayBuffer());else if(ac(r))for await(const n of r)e.push(n);else throw new Error(`Unexpected data type: ${typeof r}; constructor: ${(t=r==null?void 0:r.constructor)==null?void 0:t.name}; props: ${rc(r)}`);return e}function rc(r){return`[${Object.getOwnPropertyNames(r).map(t=>`"${t}"`).join(", ")}]`}function sc(r){var e;return Yn(r.name)||Yn(r.filename)||((e=Yn(r.path))==null?void 0:e.split(/[\\/]/).pop())}const Yn=r=>{if(typeof r=="string")return r;if(typeof Buffer<"u"&&r instanceof Buffer)return String(r)},ac=r=>r!=null&&typeof r=="object"&&typeof r[Symbol.asyncIterator]=="function",us=r=>r&&typeof r=="object"&&r.body&&r[Symbol.toStringTag]==="MultipartBody",Ct=async r=>{const e=await ic(r.body);return ta(e,r)},ic=async r=>{const e=new Ys;return await Promise.all(Object.entries(r||{}).map(([t,n])=>yr(e,t,n))),e},yr=async(r,e,t)=>{if(t!==void 0){if(t==null)throw new TypeError(`Received null for "${e}"; to pass null in FormData, you must use the string 'null'`);if(typeof t=="string"||typeof t=="number"||typeof t=="boolean")r.append(e,String(t));else if(tc(t)){const n=await _a(t);r.append(e,n)}else if(Array.isArray(t))await Promise.all(t.map(n=>yr(r,e+"[]",n)));else if(typeof t=="object")await Promise.all(Object.entries(t).map(([n,s])=>yr(r,`${e}[${n}]`,s)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${t} instead`)}};var vt={},oc=function(r,e,t,n,s){if(typeof e=="function"?r!==e||!0:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(r,t),t},cc=function(r,e,t,n){if(typeof e=="function"?r!==e||!0:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)},yn;async function va(r){const{response:e}=r;if(r.options.stream)return bt("response",e.status,e.url,e.headers,e.body),r.options.__streamClass?r.options.__streamClass.fromSSEResponse(e,r.controller):Re.fromSSEResponse(e,r.controller);if(e.status===204)return null;if(r.options.__binaryResponse)return e;const t=e.headers.get("content-type");if((t==null?void 0:t.includes("application/json"))||(t==null?void 0:t.includes("application/vnd.api+json"))){const a=await e.json();return bt("response",e.status,e.url,e.headers,a),ba(a,e)}const s=await e.text();return bt("response",e.status,e.url,e.headers,s),s}function ba(r,e){return!r||typeof r!="object"||Array.isArray(r)?r:Object.defineProperty(r,"_request_id",{value:e.headers.get("x-request-id"),enumerable:!1})}class Vn extends Promise{constructor(e,t=va){super(n=>{n(null)}),this.responsePromise=e,this.parseResponse=t}_thenUnwrap(e){return new Vn(this.responsePromise,async t=>ba(e(await this.parseResponse(t),t),t.response))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t,request_id:t.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}class lc{constructor({baseURL:e,maxRetries:t=2,timeout:n=6e5,httpAgent:s,fetch:a}){this.baseURL=e,this.maxRetries=er("maxRetries",t),this.timeout=er("timeout",n),this.httpAgent=s,this.fetch=a??Qs}authHeaders(e){return{}}defaultHeaders(e){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...pc(),...this.authHeaders(e)}}validateHeaders(e,t){}defaultIdempotencyKey(){return`stainless-node-retry-${vc()}`}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,n){return this.request(Promise.resolve(n).then(async s=>{const a=s&&Un(s==null?void 0:s.body)?new DataView(await s.body.arrayBuffer()):(s==null?void 0:s.body)instanceof DataView?s.body:(s==null?void 0:s.body)instanceof ArrayBuffer?new DataView(s.body):s&&ArrayBuffer.isView(s==null?void 0:s.body)?new DataView(s.body.buffer):s==null?void 0:s.body;return{method:e,path:t,...s,body:a}}))}getAPIList(e,t,n){return this.requestAPIList(t,{method:"get",path:e,...n})}calculateContentLength(e){if(typeof e=="string"){if(typeof Buffer<"u")return Buffer.byteLength(e,"utf8").toString();if(typeof TextEncoder<"u")return new TextEncoder().encode(e).length.toString()}else if(ArrayBuffer.isView(e))return e.byteLength.toString();return null}buildRequest(e,{retryCount:t=0}={}){var g;const{method:n,path:s,query:a,headers:i={}}=e,o=ArrayBuffer.isView(e.body)||e.__binaryRequest&&typeof e.body=="string"?e.body:us(e.body)?e.body.body:e.body?JSON.stringify(e.body,null,2):null,c=this.calculateContentLength(o),l=this.buildURL(s,a);"timeout"in e&&er("timeout",e.timeout);const u=e.timeout??this.timeout,d=e.httpAgent??this.httpAgent??na(l),m=u+1e3;typeof((g=d==null?void 0:d.options)==null?void 0:g.timeout)=="number"&&m>(d.options.timeout??0)&&(d.options.timeout=m),this.idempotencyHeader&&n!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),i[this.idempotencyHeader]=e.idempotencyKey);const _=this.buildHeaders({options:e,headers:i,contentLength:c,retryCount:t});return{req:{method:n,...o&&{body:o},headers:_,...d&&{agent:d},signal:e.signal??null},url:l,timeout:u}}buildHeaders({options:e,headers:t,contentLength:n,retryCount:s}){const a={};n&&(a["content-length"]=n);const i=this.defaultHeaders(e);return ms(a,i),ms(a,t),us(e.body)&&Ut!=="node"&&delete a["content-type"],gs(i,"x-stainless-retry-count")===void 0&&gs(t,"x-stainless-retry-count")===void 0&&(a["x-stainless-retry-count"]=String(s)),this.validateHeaders(a,t),a}async prepareOptions(e){}async prepareRequest(e,{url:t,options:n}){}parseHeaders(e){return e?Symbol.iterator in e?Object.fromEntries(Array.from(e).map(t=>[...t])):{...e}:{}}makeStatusError(e,t,n,s){return Q.generate(e,t,n,s)}request(e,t=null){return new Vn(this.makeRequest(e,t))}async makeRequest(e,t){var d,m;const n=await e,s=n.maxRetries??this.maxRetries;t==null&&(t=s),await this.prepareOptions(n);const{req:a,url:i,timeout:o}=this.buildRequest(n,{retryCount:s-t});if(await this.prepareRequest(a,{url:i,options:n}),bt("request",i,n,a.headers),(d=n.signal)!=null&&d.aborted)throw new be;const c=new AbortController,l=await this.fetchWithTimeout(i,a,o,c).catch(_r);if(l instanceof Error){if((m=n.signal)!=null&&m.aborted)throw new be;if(t)return this.retryRequest(n,t);throw l.name==="AbortError"?new Or:new Bn({cause:l})}const u=dc(l.headers);if(!l.ok){if(t&&this.shouldRetry(l)){const y=`retrying, ${t} attempts remaining`;return bt(`response (error; ${y})`,l.status,i,u),this.retryRequest(n,t,u)}const _=await l.text().catch(y=>_r(y).message),S=gc(_),g=S?void 0:_;throw bt(`response (error; ${t?"(error; no more retries left)":"(error; not retryable)"})`,l.status,i,u,g),this.makeStatusError(l.status,S,g,u)}return{response:l,options:n,controller:c}}requestAPIList(e,t){const n=this.makeRequest(t,null);return new uc(this,n,e)}buildURL(e,t){const n=_c(e)?new URL(e):new URL(this.baseURL+(this.baseURL.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),s=this.defaultQuery();return xa(s)||(t={...s,...t}),typeof t=="object"&&t&&!Array.isArray(t)&&(n.search=this.stringifyQuery(t)),n.toString()}stringifyQuery(e){return Object.entries(e).filter(([t,n])=>typeof n<"u").map(([t,n])=>{if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")return`${encodeURIComponent(t)}=${encodeURIComponent(n)}`;if(n===null)return`${encodeURIComponent(t)}=`;throw new O(`Cannot stringify type ${typeof n}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}async fetchWithTimeout(e,t,n,s){const{signal:a,...i}=t||{};a&&a.addEventListener("abort",()=>s.abort());const o=setTimeout(()=>s.abort(),n),c={signal:s.signal,...i};return c.method&&(c.method=c.method.toUpperCase()),this.fetch.call(void 0,e,c).finally(()=>{clearTimeout(o)})}shouldRetry(e){const t=e.headers.get("x-should-retry");return t==="true"?!0:t==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,t,n){let s;const a=n==null?void 0:n["retry-after-ms"];if(a){const o=parseFloat(a);Number.isNaN(o)||(s=o)}const i=n==null?void 0:n["retry-after"];if(i&&!s){const o=parseFloat(i);Number.isNaN(o)?s=Date.parse(i)-Date.now():s=o*1e3}if(!(s&&0<=s&&s<60*1e3)){const o=e.maxRetries??this.maxRetries;s=this.calculateDefaultRetryTimeoutMillis(t,o)}return await cn(s),this.makeRequest(e,t-1)}calculateDefaultRetryTimeoutMillis(e,t){const a=t-e,i=Math.min(.5*Math.pow(2,a),8),o=1-Math.random()*.25;return i*o*1e3}getUserAgent(){return`${this.constructor.name}/JS ${ht}`}}class wa{constructor(e,t,n,s){yn.set(this,void 0),oc(this,yn,e),this.options=s,this.response=t,this.body=n}hasNextPage(){return this.getPaginatedItems().length?this.nextPageInfo()!=null:!1}async getNextPage(){const e=this.nextPageInfo();if(!e)throw new O("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");const t={...this.options};if("params"in e&&typeof t.query=="object")t.query={...t.query,...e.params};else if("url"in e){const n=[...Object.entries(t.query||{}),...e.url.searchParams.entries()];for(const[s,a]of n)e.url.searchParams.set(s,a);t.query=void 0,t.path=e.url.toString()}return await cc(this,yn,"f").requestAPIList(this.constructor,t)}async*iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async*[(yn=new WeakMap,Symbol.asyncIterator)](){for await(const e of this.iterPages())for(const t of e.getPaginatedItems())yield t}}class uc extends Vn{constructor(e,t,n){super(t,async s=>new n(e,s.response,await va(s),s.options))}async*[Symbol.asyncIterator](){const e=await this;for await(const t of e)yield t}}const dc=r=>new Proxy(Object.fromEntries(r.entries()),{get(e,t){const n=t.toString();return e[n.toLowerCase()]||e[n]}}),fc={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__binaryRequest:!0,__binaryResponse:!0,__streamClass:!0},ie=r=>typeof r=="object"&&r!==null&&!xa(r)&&Object.keys(r).every(e=>ka(fc,e)),hc=()=>{var e;if(typeof Deno<"u"&&Deno.build!=null)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":ht,"X-Stainless-OS":fs(Deno.build.os),"X-Stainless-Arch":ds(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:((e=Deno.version)==null?void 0:e.deno)??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":ht,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version};if(Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":ht,"X-Stainless-OS":fs(process.platform),"X-Stainless-Arch":ds(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version};const r=mc();return r?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":ht,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${r.browser}`,"X-Stainless-Runtime-Version":r.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":ht,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function mc(){if(typeof navigator>"u"||!navigator)return null;const r=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:t}of r){const n=t.exec(navigator.userAgent);if(n){const s=n[1]||0,a=n[2]||0,i=n[3]||0;return{browser:e,version:`${s}.${a}.${i}`}}}return null}const ds=r=>r==="x32"?"x32":r==="x86_64"||r==="x64"?"x64":r==="arm"?"arm":r==="aarch64"||r==="arm64"?"arm64":r?`other:${r}`:"unknown",fs=r=>(r=r.toLowerCase(),r.includes("ios")?"iOS":r==="android"?"Android":r==="darwin"?"MacOS":r==="win32"?"Windows":r==="freebsd"?"FreeBSD":r==="openbsd"?"OpenBSD":r==="linux"?"Linux":r?`Other:${r}`:"Unknown");let hs;const pc=()=>hs??(hs=hc()),gc=r=>{try{return JSON.parse(r)}catch{return}},yc=/^[a-z][a-z0-9+.-]*:/i,_c=r=>yc.test(r),cn=r=>new Promise(e=>setTimeout(e,r)),er=(r,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new O(`${r} must be an integer`);if(e<0)throw new O(`${r} must be a positive integer`);return e},_r=r=>{if(r instanceof Error)return r;if(typeof r=="object"&&r!==null)try{return new Error(JSON.stringify(r))}catch{}return new Error(r)},_n=r=>{var e,t,n,s;if(typeof process<"u")return((e=vt==null?void 0:vt[r])==null?void 0:e.trim())??void 0;if(typeof Deno<"u")return(s=(n=(t=Deno.env)==null?void 0:t.get)==null?void 0:n.call(t,r))==null?void 0:s.trim()};function xa(r){if(!r)return!0;for(const e in r)return!1;return!0}function ka(r,e){return Object.prototype.hasOwnProperty.call(r,e)}function ms(r,e){for(const t in e){if(!ka(e,t))continue;const n=t.toLowerCase();if(!n)continue;const s=e[t];s===null?delete r[n]:s!==void 0&&(r[n]=s)}}const ps=new Set(["authorization","api-key"]);function bt(r,...e){if(typeof process<"u"&&(vt==null?void 0:vt.DEBUG)==="true"){const t=e.map(n=>{if(!n)return n;if(n.headers){const a={...n,headers:{...n.headers}};for(const i in n.headers)ps.has(i.toLowerCase())&&(a.headers[i]="REDACTED");return a}let s=null;for(const a in n)ps.has(a.toLowerCase())&&(s??(s={...n}),s[a]="REDACTED");return s??n});console.log(`OpenAI:DEBUG:${r}`,...t)}}const vc=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,r=>{const e=Math.random()*16|0;return(r==="x"?e:e&3|8).toString(16)}),bc=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u",wc=r=>typeof(r==null?void 0:r.get)=="function",gs=(r,e)=>{var n;const t=e.toLowerCase();if(wc(r)){const s=((n=e[0])==null?void 0:n.toUpperCase())+e.substring(1).replace(/([^\w])(\w)/g,(a,i,o)=>i+o.toUpperCase());for(const a of[e,t,e.toUpperCase(),s]){const i=r.get(a);if(i)return i}}for(const[s,a]of Object.entries(r))if(s.toLowerCase()===t)return Array.isArray(a)?(a.length<=1||console.warn(`Received ${a.length} entries for the ${e} header, using the first entry.`),a[0]):a};function tr(r){return r!=null&&typeof r=="object"&&!Array.isArray(r)}class xc extends wa{constructor(e,t,n,s){super(e,t,n,s),this.data=n.data||[],this.object=n.object}getPaginatedItems(){return this.data??[]}nextPageParams(){return null}nextPageInfo(){return null}}class Ae extends wa{constructor(e,t,n,s){super(e,t,n,s),this.data=n.data||[]}getPaginatedItems(){return this.data??[]}nextPageParams(){const e=this.nextPageInfo();if(!e)return null;if("params"in e)return e.params;const t=Object.fromEntries(e.url.searchParams);return Object.keys(t).length?t:null}nextPageInfo(){var n;const e=this.getPaginatedItems();if(!e.length)return null;const t=(n=e[e.length-1])==null?void 0:n.id;return t?{params:{after:t}}:null}}class D{constructor(e){this._client=e}}let Sa=class extends D{create(e,t){return this._client.post("/chat/completions",{body:e,...t,stream:e.stream??!1})}},Ir=class extends D{constructor(){super(...arguments),this.completions=new Sa(this._client)}};Ir.Completions=Sa;class Aa extends D{create(e,t){return this._client.post("/audio/speech",{body:e,...t,headers:{Accept:"application/octet-stream",...t==null?void 0:t.headers},__binaryResponse:!0})}}class Ca extends D{create(e,t){return this._client.post("/audio/transcriptions",Ct({body:e,...t}))}}class Pa extends D{create(e,t){return this._client.post("/audio/translations",Ct({body:e,...t}))}}class ln extends D{constructor(){super(...arguments),this.transcriptions=new Ca(this._client),this.translations=new Pa(this._client),this.speech=new Aa(this._client)}}ln.Transcriptions=Ca;ln.Translations=Pa;ln.Speech=Aa;class $r extends D{create(e,t){return this._client.post("/batches",{body:e,...t})}retrieve(e,t){return this._client.get(`/batches/${e}`,t)}list(e={},t){return ie(e)?this.list({},e):this._client.getAPIList("/batches",Nr,{query:e,...t})}cancel(e,t){return this._client.post(`/batches/${e}/cancel`,t)}}class Nr extends Ae{}$r.BatchesPage=Nr;class Mr extends D{create(e,t){return this._client.post("/assistants",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}retrieve(e,t){return this._client.get(`/assistants/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}update(e,t,n){return this._client.post(`/assistants/${e}`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}list(e={},t){return ie(e)?this.list({},e):this._client.getAPIList("/assistants",jr,{query:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}del(e,t){return this._client.delete(`/assistants/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}}class jr extends Ae{}Mr.AssistantsPage=jr;function ys(r){return typeof r.parse=="function"}const wt=r=>(r==null?void 0:r.role)==="assistant",Ea=r=>(r==null?void 0:r.role)==="function",Ra=r=>(r==null?void 0:r.role)==="tool";var ye=function(r,e,t,n,s){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!s:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?s.call(r,t):s?s.value=t:e.set(r,t),t},q=function(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)},vr,xn,kn,jt,Zt,Sn,Dt,je,Ft,Mn,jn,mt,Ta;class Oa{constructor(){vr.add(this),this.controller=new AbortController,xn.set(this,void 0),kn.set(this,()=>{}),jt.set(this,()=>{}),Zt.set(this,void 0),Sn.set(this,()=>{}),Dt.set(this,()=>{}),je.set(this,{}),Ft.set(this,!1),Mn.set(this,!1),jn.set(this,!1),mt.set(this,!1),ye(this,xn,new Promise((e,t)=>{ye(this,kn,e,"f"),ye(this,jt,t,"f")}),"f"),ye(this,Zt,new Promise((e,t)=>{ye(this,Sn,e,"f"),ye(this,Dt,t,"f")}),"f"),q(this,xn,"f").catch(()=>{}),q(this,Zt,"f").catch(()=>{})}_run(e){setTimeout(()=>{e().then(()=>{this._emitFinal(),this._emit("end")},q(this,vr,"m",Ta).bind(this))},0)}_connected(){this.ended||(q(this,kn,"f").call(this),this._emit("connect"))}get ended(){return q(this,Ft,"f")}get errored(){return q(this,Mn,"f")}get aborted(){return q(this,jn,"f")}abort(){this.controller.abort()}on(e,t){return(q(this,je,"f")[e]||(q(this,je,"f")[e]=[])).push({listener:t}),this}off(e,t){const n=q(this,je,"f")[e];if(!n)return this;const s=n.findIndex(a=>a.listener===t);return s>=0&&n.splice(s,1),this}once(e,t){return(q(this,je,"f")[e]||(q(this,je,"f")[e]=[])).push({listener:t,once:!0}),this}emitted(e){return new Promise((t,n)=>{ye(this,mt,!0,"f"),e!=="error"&&this.once("error",n),this.once(e,t)})}async done(){ye(this,mt,!0,"f"),await q(this,Zt,"f")}_emit(e,...t){if(q(this,Ft,"f"))return;e==="end"&&(ye(this,Ft,!0,"f"),q(this,Sn,"f").call(this));const n=q(this,je,"f")[e];if(n&&(q(this,je,"f")[e]=n.filter(s=>!s.once),n.forEach(({listener:s})=>s(...t))),e==="abort"){const s=t[0];!q(this,mt,"f")&&!(n!=null&&n.length)&&Promise.reject(s),q(this,jt,"f").call(this,s),q(this,Dt,"f").call(this,s),this._emit("end");return}if(e==="error"){const s=t[0];!q(this,mt,"f")&&!(n!=null&&n.length)&&Promise.reject(s),q(this,jt,"f").call(this,s),q(this,Dt,"f").call(this,s),this._emit("end")}}_emitFinal(){}}xn=new WeakMap,kn=new WeakMap,jt=new WeakMap,Zt=new WeakMap,Sn=new WeakMap,Dt=new WeakMap,je=new WeakMap,Ft=new WeakMap,Mn=new WeakMap,jn=new WeakMap,mt=new WeakMap,vr=new WeakSet,Ta=function(e){if(ye(this,Mn,!0,"f"),e instanceof Error&&e.name==="AbortError"&&(e=new be),e instanceof be)return ye(this,jn,!0,"f"),this._emit("abort",e);if(e instanceof O)return this._emit("error",e);if(e instanceof Error){const t=new O(e.message);return t.cause=e,this._emit("error",t)}return this._emit("error",new O(String(e)))};function kc(r,e){const t={...r};return Object.defineProperties(t,{$brand:{value:"auto-parseable-response-format",enumerable:!1},$parseRaw:{value:e,enumerable:!1}}),t}function Ia(r){return(r==null?void 0:r.$brand)==="auto-parseable-response-format"}function un(r){return(r==null?void 0:r.$brand)==="auto-parseable-tool"}function Sc(r,e){return!e||!$a(e)?{...r,choices:r.choices.map(t=>({...t,message:{...t.message,parsed:null,tool_calls:t.message.tool_calls??[]}}))}:Zr(r,e)}function Zr(r,e){const t=r.choices.map(n=>{var s;if(n.finish_reason==="length")throw new ha;if(n.finish_reason==="content_filter")throw new ma;return{...n,message:{...n.message,tool_calls:((s=n.message.tool_calls)==null?void 0:s.map(a=>Cc(e,a)))??[],parsed:n.message.content&&!n.message.refusal?Ac(e,n.message.content):null}}});return{...r,choices:t}}function Ac(r,e){var t,n;return((t=r.response_format)==null?void 0:t.type)!=="json_schema"?null:((n=r.response_format)==null?void 0:n.type)==="json_schema"?"$parseRaw"in r.response_format?r.response_format.$parseRaw(e):JSON.parse(e):null}function Cc(r,e){var n;const t=(n=r.tools)==null?void 0:n.find(s=>{var a;return((a=s.function)==null?void 0:a.name)===e.function.name});return{...e,function:{...e.function,parsed_arguments:un(t)?t.$parseRaw(e.function.arguments):t!=null&&t.function.strict?JSON.parse(e.function.arguments):null}}}function Pc(r,e){var n;if(!r)return!1;const t=(n=r.tools)==null?void 0:n.find(s=>{var a;return((a=s.function)==null?void 0:a.name)===e.function.name});return un(t)||(t==null?void 0:t.function.strict)||!1}function $a(r){var e;return Ia(r.response_format)?!0:((e=r.tools)==null?void 0:e.some(t=>un(t)||t.type==="function"&&t.function.strict===!0))??!1}function Ec(r){for(const e of r??[]){if(e.type!=="function")throw new O(`Currently only \`function\` tool types support auto-parsing; Received \`${e.type}\``);if(e.function.strict!==!0)throw new O(`The \`${e.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}var se=function(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)},Y,br,Zn,wr,xr,kr,Na,Sr;const _s=10;class Ma extends Oa{constructor(){super(...arguments),Y.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(e){var n;this._chatCompletions.push(e),this._emit("chatCompletion",e);const t=(n=e.choices[0])==null?void 0:n.message;return t&&this._addMessage(t),e}_addMessage(e,t=!0){if("content"in e||(e.content=null),this.messages.push(e),t){if(this._emit("message",e),(Ea(e)||Ra(e))&&e.content)this._emit("functionCallResult",e.content);else if(wt(e)&&e.function_call)this._emit("functionCall",e.function_call);else if(wt(e)&&e.tool_calls)for(const n of e.tool_calls)n.type==="function"&&this._emit("functionCall",n.function)}}async finalChatCompletion(){await this.done();const e=this._chatCompletions[this._chatCompletions.length-1];if(!e)throw new O("stream ended without producing a ChatCompletion");return e}async finalContent(){return await this.done(),se(this,Y,"m",br).call(this)}async finalMessage(){return await this.done(),se(this,Y,"m",Zn).call(this)}async finalFunctionCall(){return await this.done(),se(this,Y,"m",wr).call(this)}async finalFunctionCallResult(){return await this.done(),se(this,Y,"m",xr).call(this)}async totalUsage(){return await this.done(),se(this,Y,"m",kr).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){const e=this._chatCompletions[this._chatCompletions.length-1];e&&this._emit("finalChatCompletion",e);const t=se(this,Y,"m",Zn).call(this);t&&this._emit("finalMessage",t);const n=se(this,Y,"m",br).call(this);n&&this._emit("finalContent",n);const s=se(this,Y,"m",wr).call(this);s&&this._emit("finalFunctionCall",s);const a=se(this,Y,"m",xr).call(this);a!=null&&this._emit("finalFunctionCallResult",a),this._chatCompletions.some(i=>i.usage)&&this._emit("totalUsage",se(this,Y,"m",kr).call(this))}async _createChatCompletion(e,t,n){const s=n==null?void 0:n.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),se(this,Y,"m",Na).call(this,t);const a=await e.chat.completions.create({...t,stream:!1},{...n,signal:this.controller.signal});return this._connected(),this._addChatCompletion(Zr(a,t))}async _runChatCompletion(e,t,n){for(const s of t.messages)this._addMessage(s,!1);return await this._createChatCompletion(e,t,n)}async _runFunctions(e,t,n){var m;const s="function",{function_call:a="auto",stream:i,...o}=t,c=typeof a!="string"&&(a==null?void 0:a.name),{maxChatCompletions:l=_s}=n||{},u={};for(const _ of t.functions)u[_.name||_.function.name]=_;const d=t.functions.map(_=>({name:_.name||_.function.name,parameters:_.parameters,description:_.description}));for(const _ of t.messages)this._addMessage(_,!1);for(let _=0;_<l;++_){const g=(m=(await this._createChatCompletion(e,{...o,function_call:a,functions:d,messages:[...this.messages]},n)).choices[0])==null?void 0:m.message;if(!g)throw new O("missing message in ChatCompletion response");if(!g.function_call)return;const{name:b,arguments:$}=g.function_call,y=u[b];if(y){if(c&&c!==b){const T=`Invalid function_call: ${JSON.stringify(b)}. ${JSON.stringify(c)} requested. Please try again`;this._addMessage({role:s,name:b,content:T});continue}}else{const T=`Invalid function_call: ${JSON.stringify(b)}. Available options are: ${d.map(R=>JSON.stringify(R.name)).join(", ")}. Please try again`;this._addMessage({role:s,name:b,content:T});continue}let P;try{P=ys(y)?await y.parse($):$}catch(T){this._addMessage({role:s,name:b,content:T instanceof Error?T.message:String(T)});continue}const k=await y.function(P,this),F=se(this,Y,"m",Sr).call(this,k);if(this._addMessage({role:s,name:b,content:F}),c)return}}async _runTools(e,t,n){var _,S,g;const s="tool",{tool_choice:a="auto",stream:i,...o}=t,c=typeof a!="string"&&((_=a==null?void 0:a.function)==null?void 0:_.name),{maxChatCompletions:l=_s}=n||{},u=t.tools.map(b=>{if(un(b)){if(!b.$callback)throw new O("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:b.$callback,name:b.function.name,description:b.function.description||"",parameters:b.function.parameters,parse:b.$parseRaw,strict:!0}}}return b}),d={};for(const b of u)b.type==="function"&&(d[b.function.name||b.function.function.name]=b.function);const m="tools"in t?u.map(b=>b.type==="function"?{type:"function",function:{name:b.function.name||b.function.function.name,parameters:b.function.parameters,description:b.function.description,strict:b.function.strict}}:b):void 0;for(const b of t.messages)this._addMessage(b,!1);for(let b=0;b<l;++b){const y=(S=(await this._createChatCompletion(e,{...o,tool_choice:a,tools:m,messages:[...this.messages]},n)).choices[0])==null?void 0:S.message;if(!y)throw new O("missing message in ChatCompletion response");if(!((g=y.tool_calls)!=null&&g.length))return;for(const P of y.tool_calls){if(P.type!=="function")continue;const k=P.id,{name:F,arguments:T}=P.function,R=d[F];if(R){if(c&&c!==F){const j=`Invalid tool_call: ${JSON.stringify(F)}. ${JSON.stringify(c)} requested. Please try again`;this._addMessage({role:s,tool_call_id:k,content:j});continue}}else{const j=`Invalid tool_call: ${JSON.stringify(F)}. Available options are: ${Object.keys(d).map(de=>JSON.stringify(de)).join(", ")}. Please try again`;this._addMessage({role:s,tool_call_id:k,content:j});continue}let I;try{I=ys(R)?await R.parse(T):T}catch(j){const de=j instanceof Error?j.message:String(j);this._addMessage({role:s,tool_call_id:k,content:de});continue}const L=await R.function(I,this),B=se(this,Y,"m",Sr).call(this,L);if(this._addMessage({role:s,tool_call_id:k,content:B}),c)return}}}}Y=new WeakSet,br=function(){return se(this,Y,"m",Zn).call(this).content??null},Zn=function(){let e=this.messages.length;for(;e-- >0;){const t=this.messages[e];if(wt(t)){const{function_call:n,...s}=t,a={...s,content:t.content??null,refusal:t.refusal??null};return n&&(a.function_call=n),a}}throw new O("stream ended without producing a ChatCompletionMessage with role=assistant")},wr=function(){var e,t;for(let n=this.messages.length-1;n>=0;n--){const s=this.messages[n];if(wt(s)&&(s!=null&&s.function_call))return s.function_call;if(wt(s)&&((e=s==null?void 0:s.tool_calls)!=null&&e.length))return(t=s.tool_calls.at(-1))==null?void 0:t.function}},xr=function(){for(let e=this.messages.length-1;e>=0;e--){const t=this.messages[e];if(Ea(t)&&t.content!=null||Ra(t)&&t.content!=null&&typeof t.content=="string"&&this.messages.some(n=>{var s;return n.role==="assistant"&&((s=n.tool_calls)==null?void 0:s.some(a=>a.type==="function"&&a.id===t.tool_call_id))}))return t.content}},kr=function(){const e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:t}of this._chatCompletions)t&&(e.completion_tokens+=t.completion_tokens,e.prompt_tokens+=t.prompt_tokens,e.total_tokens+=t.total_tokens);return e},Na=function(e){if(e.n!=null&&e.n>1)throw new O("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},Sr=function(e){return typeof e=="string"?e:e===void 0?"undefined":JSON.stringify(e)};class rn extends Ma{static runFunctions(e,t,n){const s=new rn,a={...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"runFunctions"}};return s._run(()=>s._runFunctions(e,t,a)),s}static runTools(e,t,n){const s=new rn,a={...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"runTools"}};return s._run(()=>s._runTools(e,t,a)),s}_addMessage(e,t=!0){super._addMessage(e,t),wt(e)&&e.content&&this._emit("content",e.content)}}const ja=1,Za=2,Da=4,Fa=8,La=16,Ba=32,Ua=64,Va=128,qa=256,Rc=Va|qa,Tc=La|Ba|Rc|Ua,Oc=ja|Za|Tc,Ic=Da|Fa,$c=Oc|Ic,K={STR:ja,NUM:Za,ARR:Da,OBJ:Fa,NULL:La,BOOL:Ba,NAN:Ua,INFINITY:Va,MINUS_INFINITY:qa,ALL:$c};class Nc extends Error{}class Mc extends Error{}function jc(r,e=K.ALL){if(typeof r!="string")throw new TypeError(`expecting str, got ${typeof r}`);if(!r.trim())throw new Error(`${r} is empty`);return Zc(r.trim(),e)}const Zc=(r,e)=>{const t=r.length;let n=0;const s=m=>{throw new Nc(`${m} at position ${n}`)},a=m=>{throw new Mc(`${m} at position ${n}`)},i=()=>(d(),n>=t&&s("Unexpected end of input"),r[n]==='"'?o():r[n]==="{"?c():r[n]==="["?l():r.substring(n,n+4)==="null"||K.NULL&e&&t-n<4&&"null".startsWith(r.substring(n))?(n+=4,null):r.substring(n,n+4)==="true"||K.BOOL&e&&t-n<4&&"true".startsWith(r.substring(n))?(n+=4,!0):r.substring(n,n+5)==="false"||K.BOOL&e&&t-n<5&&"false".startsWith(r.substring(n))?(n+=5,!1):r.substring(n,n+8)==="Infinity"||K.INFINITY&e&&t-n<8&&"Infinity".startsWith(r.substring(n))?(n+=8,1/0):r.substring(n,n+9)==="-Infinity"||K.MINUS_INFINITY&e&&1<t-n&&t-n<9&&"-Infinity".startsWith(r.substring(n))?(n+=9,-1/0):r.substring(n,n+3)==="NaN"||K.NAN&e&&t-n<3&&"NaN".startsWith(r.substring(n))?(n+=3,NaN):u()),o=()=>{const m=n;let _=!1;for(n++;n<t&&(r[n]!=='"'||_&&r[n-1]==="\\");)_=r[n]==="\\"?!_:!1,n++;if(r.charAt(n)=='"')try{return JSON.parse(r.substring(m,++n-Number(_)))}catch(S){a(String(S))}else if(K.STR&e)try{return JSON.parse(r.substring(m,n-Number(_))+'"')}catch{return JSON.parse(r.substring(m,r.lastIndexOf("\\"))+'"')}s("Unterminated string literal")},c=()=>{n++,d();const m={};try{for(;r[n]!=="}";){if(d(),n>=t&&K.OBJ&e)return m;const _=o();d(),n++;try{const S=i();Object.defineProperty(m,_,{value:S,writable:!0,enumerable:!0,configurable:!0})}catch(S){if(K.OBJ&e)return m;throw S}d(),r[n]===","&&n++}}catch{if(K.OBJ&e)return m;s("Expected '}' at end of object")}return n++,m},l=()=>{n++;const m=[];try{for(;r[n]!=="]";)m.push(i()),d(),r[n]===","&&n++}catch{if(K.ARR&e)return m;s("Expected ']' at end of array")}return n++,m},u=()=>{if(n===0){r==="-"&&K.NUM&e&&s("Not sure what '-' is");try{return JSON.parse(r)}catch(_){if(K.NUM&e)try{return r[r.length-1]==="."?JSON.parse(r.substring(0,r.lastIndexOf("."))):JSON.parse(r.substring(0,r.lastIndexOf("e")))}catch{}a(String(_))}}const m=n;for(r[n]==="-"&&n++;r[n]&&!",]}".includes(r[n]);)n++;n==t&&!(K.NUM&e)&&s("Unterminated number literal");try{return JSON.parse(r.substring(m,n))}catch{r.substring(m,n)==="-"&&K.NUM&e&&s("Not sure what '-' is");try{return JSON.parse(r.substring(m,r.lastIndexOf("e")))}catch(S){a(String(S))}}},d=()=>{for(;n<t&&` 
\r	`.includes(r[n]);)n++};return i()},vs=r=>jc(r,K.ALL^K.NUM);var ut=function(r,e,t,n,s){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!s:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?s.call(r,t):s?s.value=t:e.set(r,t),t},V=function(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)},H,Ne,dt,Ue,nr,vn,rr,sr,ar,bn,ir,bs;class sn extends Ma{constructor(e){super(),H.add(this),Ne.set(this,void 0),dt.set(this,void 0),Ue.set(this,void 0),ut(this,Ne,e,"f"),ut(this,dt,[],"f")}get currentChatCompletionSnapshot(){return V(this,Ue,"f")}static fromReadableStream(e){const t=new sn(null);return t._run(()=>t._fromReadableStream(e)),t}static createChatCompletion(e,t,n){const s=new sn(t);return s._run(()=>s._runChatCompletion(e,{...t,stream:!0},{...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"stream"}})),s}async _createChatCompletion(e,t,n){var i;super._createChatCompletion;const s=n==null?void 0:n.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),V(this,H,"m",nr).call(this);const a=await e.chat.completions.create({...t,stream:!0},{...n,signal:this.controller.signal});this._connected();for await(const o of a)V(this,H,"m",rr).call(this,o);if((i=a.controller.signal)!=null&&i.aborted)throw new be;return this._addChatCompletion(V(this,H,"m",bn).call(this))}async _fromReadableStream(e,t){var i;const n=t==null?void 0:t.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),V(this,H,"m",nr).call(this),this._connected();const s=Re.fromReadableStream(e,this.controller);let a;for await(const o of s)a&&a!==o.id&&this._addChatCompletion(V(this,H,"m",bn).call(this)),V(this,H,"m",rr).call(this,o),a=o.id;if((i=s.controller.signal)!=null&&i.aborted)throw new be;return this._addChatCompletion(V(this,H,"m",bn).call(this))}[(Ne=new WeakMap,dt=new WeakMap,Ue=new WeakMap,H=new WeakSet,nr=function(){this.ended||ut(this,Ue,void 0,"f")},vn=function(t){let n=V(this,dt,"f")[t.index];return n||(n={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},V(this,dt,"f")[t.index]=n,n)},rr=function(t){var s,a,i,o,c,l,u,d,m,_,S,g,b,$,y;if(this.ended)return;const n=V(this,H,"m",bs).call(this,t);this._emit("chunk",t,n);for(const P of t.choices){const k=n.choices[P.index];P.delta.content!=null&&((s=k.message)==null?void 0:s.role)==="assistant"&&((a=k.message)!=null&&a.content)&&(this._emit("content",P.delta.content,k.message.content),this._emit("content.delta",{delta:P.delta.content,snapshot:k.message.content,parsed:k.message.parsed})),P.delta.refusal!=null&&((i=k.message)==null?void 0:i.role)==="assistant"&&((o=k.message)!=null&&o.refusal)&&this._emit("refusal.delta",{delta:P.delta.refusal,snapshot:k.message.refusal}),((c=P.logprobs)==null?void 0:c.content)!=null&&((l=k.message)==null?void 0:l.role)==="assistant"&&this._emit("logprobs.content.delta",{content:(u=P.logprobs)==null?void 0:u.content,snapshot:((d=k.logprobs)==null?void 0:d.content)??[]}),((m=P.logprobs)==null?void 0:m.refusal)!=null&&((_=k.message)==null?void 0:_.role)==="assistant"&&this._emit("logprobs.refusal.delta",{refusal:(S=P.logprobs)==null?void 0:S.refusal,snapshot:((g=k.logprobs)==null?void 0:g.refusal)??[]});const F=V(this,H,"m",vn).call(this,k);k.finish_reason&&(V(this,H,"m",ar).call(this,k),F.current_tool_call_index!=null&&V(this,H,"m",sr).call(this,k,F.current_tool_call_index));for(const T of P.delta.tool_calls??[])F.current_tool_call_index!==T.index&&(V(this,H,"m",ar).call(this,k),F.current_tool_call_index!=null&&V(this,H,"m",sr).call(this,k,F.current_tool_call_index)),F.current_tool_call_index=T.index;for(const T of P.delta.tool_calls??[]){const R=(b=k.message.tool_calls)==null?void 0:b[T.index];R!=null&&R.type&&((R==null?void 0:R.type)==="function"?this._emit("tool_calls.function.arguments.delta",{name:($=R.function)==null?void 0:$.name,index:T.index,arguments:R.function.arguments,parsed_arguments:R.function.parsed_arguments,arguments_delta:((y=T.function)==null?void 0:y.arguments)??""}):(R==null||R.type,void 0))}}},sr=function(t,n){var i,o,c;if(V(this,H,"m",vn).call(this,t).done_tool_calls.has(n))return;const a=(i=t.message.tool_calls)==null?void 0:i[n];if(!a)throw new Error("no tool call snapshot");if(!a.type)throw new Error("tool call snapshot missing `type`");if(a.type==="function"){const l=(c=(o=V(this,Ne,"f"))==null?void 0:o.tools)==null?void 0:c.find(u=>u.type==="function"&&u.function.name===a.function.name);this._emit("tool_calls.function.arguments.done",{name:a.function.name,index:n,arguments:a.function.arguments,parsed_arguments:un(l)?l.$parseRaw(a.function.arguments):l!=null&&l.function.strict?JSON.parse(a.function.arguments):null})}else a.type},ar=function(t){var s,a;const n=V(this,H,"m",vn).call(this,t);if(t.message.content&&!n.content_done){n.content_done=!0;const i=V(this,H,"m",ir).call(this);this._emit("content.done",{content:t.message.content,parsed:i?i.$parseRaw(t.message.content):null})}t.message.refusal&&!n.refusal_done&&(n.refusal_done=!0,this._emit("refusal.done",{refusal:t.message.refusal})),(s=t.logprobs)!=null&&s.content&&!n.logprobs_content_done&&(n.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:t.logprobs.content})),(a=t.logprobs)!=null&&a.refusal&&!n.logprobs_refusal_done&&(n.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:t.logprobs.refusal}))},bn=function(){if(this.ended)throw new O("stream has ended, this shouldn't happen");const t=V(this,Ue,"f");if(!t)throw new O("request ended without sending any chunks");return ut(this,Ue,void 0,"f"),ut(this,dt,[],"f"),Dc(t,V(this,Ne,"f"))},ir=function(){var n;const t=(n=V(this,Ne,"f"))==null?void 0:n.response_format;return Ia(t)?t:null},bs=function(t){var n,s,a,i;let o=V(this,Ue,"f");const{choices:c,...l}=t;o?Object.assign(o,l):o=ut(this,Ue,{...l,choices:[]},"f");for(const{delta:u,finish_reason:d,index:m,logprobs:_=null,...S}of t.choices){let g=o.choices[m];if(g||(g=o.choices[m]={finish_reason:d,index:m,message:{},logprobs:_,...S}),_)if(!g.logprobs)g.logprobs=Object.assign({},_);else{const{content:T,refusal:R,...I}=_;Object.assign(g.logprobs,I),T&&((n=g.logprobs).content??(n.content=[]),g.logprobs.content.push(...T)),R&&((s=g.logprobs).refusal??(s.refusal=[]),g.logprobs.refusal.push(...R))}if(d&&(g.finish_reason=d,V(this,Ne,"f")&&$a(V(this,Ne,"f")))){if(d==="length")throw new ha;if(d==="content_filter")throw new ma}if(Object.assign(g,S),!u)continue;const{content:b,refusal:$,function_call:y,role:P,tool_calls:k,...F}=u;if(Object.assign(g.message,F),$&&(g.message.refusal=(g.message.refusal||"")+$),P&&(g.message.role=P),y&&(g.message.function_call?(y.name&&(g.message.function_call.name=y.name),y.arguments&&((a=g.message.function_call).arguments??(a.arguments=""),g.message.function_call.arguments+=y.arguments)):g.message.function_call=y),b&&(g.message.content=(g.message.content||"")+b,!g.message.refusal&&V(this,H,"m",ir).call(this)&&(g.message.parsed=vs(g.message.content))),k){g.message.tool_calls||(g.message.tool_calls=[]);for(const{index:T,id:R,type:I,function:L,...B}of k){const j=(i=g.message.tool_calls)[T]??(i[T]={});Object.assign(j,B),R&&(j.id=R),I&&(j.type=I),L&&(j.function??(j.function={name:L.name??"",arguments:""})),L!=null&&L.name&&(j.function.name=L.name),L!=null&&L.arguments&&(j.function.arguments+=L.arguments,Pc(V(this,Ne,"f"),j)&&(j.function.parsed_arguments=vs(j.function.arguments)))}}}return o},Symbol.asyncIterator)](){const e=[],t=[];let n=!1;return this.on("chunk",s=>{const a=t.shift();a?a.resolve(s):e.push(s)}),this.on("end",()=>{n=!0;for(const s of t)s.resolve(void 0);t.length=0}),this.on("abort",s=>{n=!0;for(const a of t)a.reject(s);t.length=0}),this.on("error",s=>{n=!0;for(const a of t)a.reject(s);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:n?{value:void 0,done:!0}:new Promise((a,i)=>t.push({resolve:a,reject:i})).then(a=>a?{value:a,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new Re(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function Dc(r,e){const{id:t,choices:n,created:s,model:a,system_fingerprint:i,...o}=r,c={...o,id:t,choices:n.map(({message:l,finish_reason:u,index:d,logprobs:m,..._})=>{if(!u)throw new O(`missing finish_reason for choice ${d}`);const{content:S=null,function_call:g,tool_calls:b,...$}=l,y=l.role;if(!y)throw new O(`missing role for choice ${d}`);if(g){const{arguments:P,name:k}=g;if(P==null)throw new O(`missing function_call.arguments for choice ${d}`);if(!k)throw new O(`missing function_call.name for choice ${d}`);return{..._,message:{content:S,function_call:{arguments:P,name:k},role:y,refusal:l.refusal??null},finish_reason:u,index:d,logprobs:m}}return b?{..._,index:d,finish_reason:u,logprobs:m,message:{...$,role:y,content:S,refusal:l.refusal??null,tool_calls:b.map((P,k)=>{const{function:F,type:T,id:R,...I}=P,{arguments:L,name:B,...j}=F||{};if(R==null)throw new O(`missing choices[${d}].tool_calls[${k}].id
${wn(r)}`);if(T==null)throw new O(`missing choices[${d}].tool_calls[${k}].type
${wn(r)}`);if(B==null)throw new O(`missing choices[${d}].tool_calls[${k}].function.name
${wn(r)}`);if(L==null)throw new O(`missing choices[${d}].tool_calls[${k}].function.arguments
${wn(r)}`);return{...I,id:R,type:T,function:{...j,name:B,arguments:L}}})}}:{..._,message:{...$,content:S,role:y,refusal:l.refusal??null},finish_reason:u,index:d,logprobs:m}}),created:s,model:a,object:"chat.completion",...i?{system_fingerprint:i}:{}};return Sc(c,e)}function wn(r){return JSON.stringify(r)}class xt extends sn{static fromReadableStream(e){const t=new xt(null);return t._run(()=>t._fromReadableStream(e)),t}static runFunctions(e,t,n){const s=new xt(null),a={...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"runFunctions"}};return s._run(()=>s._runFunctions(e,t,a)),s}static runTools(e,t,n){const s=new xt(t),a={...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"runTools"}};return s._run(()=>s._runTools(e,t,a)),s}}let za=class extends D{parse(e,t){return Ec(e.tools),this._client.chat.completions.create(e,{...t,headers:{...t==null?void 0:t.headers,"X-Stainless-Helper-Method":"beta.chat.completions.parse"}})._thenUnwrap(n=>Zr(n,e))}runFunctions(e,t){return e.stream?xt.runFunctions(this._client,e,t):rn.runFunctions(this._client,e,t)}runTools(e,t){return e.stream?xt.runTools(this._client,e,t):rn.runTools(this._client,e,t)}stream(e,t){return sn.createChatCompletion(this._client,e,t)}};class Ar extends D{constructor(){super(...arguments),this.completions=new za(this._client)}}(function(r){r.Completions=za})(Ar||(Ar={}));class Wa extends D{create(e,t){return this._client.post("/realtime/sessions",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}}class Dr extends D{constructor(){super(...arguments),this.sessions=new Wa(this._client)}}Dr.Sessions=Wa;var x=function(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)},oe=function(r,e,t,n,s){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!s:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?s.call(r,t):s?s.value=t:e.set(r,t),t},G,Cr,Ee,An,_e,et,yt,Ye,Dn,ce,Cn,Pn,Vt,Lt,Bt,ws,xs,ks,Ss,As,Cs,Ps;class we extends Oa{constructor(){super(...arguments),G.add(this),Cr.set(this,[]),Ee.set(this,{}),An.set(this,{}),_e.set(this,void 0),et.set(this,void 0),yt.set(this,void 0),Ye.set(this,void 0),Dn.set(this,void 0),ce.set(this,void 0),Cn.set(this,void 0),Pn.set(this,void 0),Vt.set(this,void 0)}[(Cr=new WeakMap,Ee=new WeakMap,An=new WeakMap,_e=new WeakMap,et=new WeakMap,yt=new WeakMap,Ye=new WeakMap,Dn=new WeakMap,ce=new WeakMap,Cn=new WeakMap,Pn=new WeakMap,Vt=new WeakMap,G=new WeakSet,Symbol.asyncIterator)](){const e=[],t=[];let n=!1;return this.on("event",s=>{const a=t.shift();a?a.resolve(s):e.push(s)}),this.on("end",()=>{n=!0;for(const s of t)s.resolve(void 0);t.length=0}),this.on("abort",s=>{n=!0;for(const a of t)a.reject(s);t.length=0}),this.on("error",s=>{n=!0;for(const a of t)a.reject(s);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:n?{value:void 0,done:!0}:new Promise((a,i)=>t.push({resolve:a,reject:i})).then(a=>a?{value:a,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(e){const t=new we;return t._run(()=>t._fromReadableStream(e)),t}async _fromReadableStream(e,t){var a;const n=t==null?void 0:t.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),this._connected();const s=Re.fromReadableStream(e,this.controller);for await(const i of s)x(this,G,"m",Lt).call(this,i);if((a=s.controller.signal)!=null&&a.aborted)throw new be;return this._addRun(x(this,G,"m",Bt).call(this))}toReadableStream(){return new Re(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(e,t,n,s,a){const i=new we;return i._run(()=>i._runToolAssistantStream(e,t,n,s,{...a,headers:{...a==null?void 0:a.headers,"X-Stainless-Helper-Method":"stream"}})),i}async _createToolAssistantStream(e,t,n,s,a){var l;const i=a==null?void 0:a.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort()));const o={...s,stream:!0},c=await e.submitToolOutputs(t,n,o,{...a,signal:this.controller.signal});this._connected();for await(const u of c)x(this,G,"m",Lt).call(this,u);if((l=c.controller.signal)!=null&&l.aborted)throw new be;return this._addRun(x(this,G,"m",Bt).call(this))}static createThreadAssistantStream(e,t,n){const s=new we;return s._run(()=>s._threadAssistantStream(e,t,{...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"stream"}})),s}static createAssistantStream(e,t,n,s){const a=new we;return a._run(()=>a._runAssistantStream(e,t,n,{...s,headers:{...s==null?void 0:s.headers,"X-Stainless-Helper-Method":"stream"}})),a}currentEvent(){return x(this,Cn,"f")}currentRun(){return x(this,Pn,"f")}currentMessageSnapshot(){return x(this,_e,"f")}currentRunStepSnapshot(){return x(this,Vt,"f")}async finalRunSteps(){return await this.done(),Object.values(x(this,Ee,"f"))}async finalMessages(){return await this.done(),Object.values(x(this,An,"f"))}async finalRun(){if(await this.done(),!x(this,et,"f"))throw Error("Final run was not received.");return x(this,et,"f")}async _createThreadAssistantStream(e,t,n){var o;const s=n==null?void 0:n.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort()));const a={...t,stream:!0},i=await e.createAndRun(a,{...n,signal:this.controller.signal});this._connected();for await(const c of i)x(this,G,"m",Lt).call(this,c);if((o=i.controller.signal)!=null&&o.aborted)throw new be;return this._addRun(x(this,G,"m",Bt).call(this))}async _createAssistantStream(e,t,n,s){var c;const a=s==null?void 0:s.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort()));const i={...n,stream:!0},o=await e.create(t,i,{...s,signal:this.controller.signal});this._connected();for await(const l of o)x(this,G,"m",Lt).call(this,l);if((c=o.controller.signal)!=null&&c.aborted)throw new be;return this._addRun(x(this,G,"m",Bt).call(this))}static accumulateDelta(e,t){for(const[n,s]of Object.entries(t)){if(!e.hasOwnProperty(n)){e[n]=s;continue}let a=e[n];if(a==null){e[n]=s;continue}if(n==="index"||n==="type"){e[n]=s;continue}if(typeof a=="string"&&typeof s=="string")a+=s;else if(typeof a=="number"&&typeof s=="number")a+=s;else if(tr(a)&&tr(s))a=this.accumulateDelta(a,s);else if(Array.isArray(a)&&Array.isArray(s)){if(a.every(i=>typeof i=="string"||typeof i=="number")){a.push(...s);continue}for(const i of s){if(!tr(i))throw new Error(`Expected array delta entry to be an object but got: ${i}`);const o=i.index;if(o==null)throw console.error(i),new Error("Expected array delta entry to have an `index` property");if(typeof o!="number")throw new Error(`Expected array delta entry \`index\` property to be a number but got ${o}`);const c=a[o];c==null?a.push(i):a[o]=this.accumulateDelta(c,i)}continue}else throw Error(`Unhandled record type: ${n}, deltaValue: ${s}, accValue: ${a}`);e[n]=a}return e}_addRun(e){return e}async _threadAssistantStream(e,t,n){return await this._createThreadAssistantStream(t,e,n)}async _runAssistantStream(e,t,n,s){return await this._createAssistantStream(t,e,n,s)}async _runToolAssistantStream(e,t,n,s,a){return await this._createToolAssistantStream(n,e,t,s,a)}}Lt=function(e){if(!this.ended)switch(oe(this,Cn,e,"f"),x(this,G,"m",ks).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":x(this,G,"m",Ps).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":x(this,G,"m",xs).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":x(this,G,"m",ws).call(this,e);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},Bt=function(){if(this.ended)throw new O("stream has ended, this shouldn't happen");if(!x(this,et,"f"))throw Error("Final run has not been received");return x(this,et,"f")},ws=function(e){const[t,n]=x(this,G,"m",As).call(this,e,x(this,_e,"f"));oe(this,_e,t,"f"),x(this,An,"f")[t.id]=t;for(const s of n){const a=t.content[s.index];(a==null?void 0:a.type)=="text"&&this._emit("textCreated",a.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,t),e.data.delta.content)for(const s of e.data.delta.content){if(s.type=="text"&&s.text){let a=s.text,i=t.content[s.index];if(i&&i.type=="text")this._emit("textDelta",a,i.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(s.index!=x(this,yt,"f")){if(x(this,Ye,"f"))switch(x(this,Ye,"f").type){case"text":this._emit("textDone",x(this,Ye,"f").text,x(this,_e,"f"));break;case"image_file":this._emit("imageFileDone",x(this,Ye,"f").image_file,x(this,_e,"f"));break}oe(this,yt,s.index,"f")}oe(this,Ye,t.content[s.index],"f")}break;case"thread.message.completed":case"thread.message.incomplete":if(x(this,yt,"f")!==void 0){const s=e.data.content[x(this,yt,"f")];if(s)switch(s.type){case"image_file":this._emit("imageFileDone",s.image_file,x(this,_e,"f"));break;case"text":this._emit("textDone",s.text,x(this,_e,"f"));break}}x(this,_e,"f")&&this._emit("messageDone",e.data),oe(this,_e,void 0,"f")}},xs=function(e){const t=x(this,G,"m",Ss).call(this,e);switch(oe(this,Vt,t,"f"),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":const n=e.data.delta;if(n.step_details&&n.step_details.type=="tool_calls"&&n.step_details.tool_calls&&t.step_details.type=="tool_calls")for(const a of n.step_details.tool_calls)a.index==x(this,Dn,"f")?this._emit("toolCallDelta",a,t.step_details.tool_calls[a.index]):(x(this,ce,"f")&&this._emit("toolCallDone",x(this,ce,"f")),oe(this,Dn,a.index,"f"),oe(this,ce,t.step_details.tool_calls[a.index],"f"),x(this,ce,"f")&&this._emit("toolCallCreated",x(this,ce,"f")));this._emit("runStepDelta",e.data.delta,t);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":oe(this,Vt,void 0,"f"),e.data.step_details.type=="tool_calls"&&x(this,ce,"f")&&(this._emit("toolCallDone",x(this,ce,"f")),oe(this,ce,void 0,"f")),this._emit("runStepDone",e.data,t);break}},ks=function(e){x(this,Cr,"f").push(e),this._emit("event",e)},Ss=function(e){switch(e.event){case"thread.run.step.created":return x(this,Ee,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let t=x(this,Ee,"f")[e.data.id];if(!t)throw Error("Received a RunStepDelta before creation of a snapshot");let n=e.data;if(n.delta){const s=we.accumulateDelta(t,n.delta);x(this,Ee,"f")[e.data.id]=s}return x(this,Ee,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":x(this,Ee,"f")[e.data.id]=e.data;break}if(x(this,Ee,"f")[e.data.id])return x(this,Ee,"f")[e.data.id];throw new Error("No snapshot available")},As=function(e,t){let n=[];switch(e.event){case"thread.message.created":return[e.data,n];case"thread.message.delta":if(!t)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let s=e.data;if(s.delta.content)for(const a of s.delta.content)if(a.index in t.content){let i=t.content[a.index];t.content[a.index]=x(this,G,"m",Cs).call(this,a,i)}else t.content[a.index]=a,n.push(a);return[t,n];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(t)return[t,n];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},Cs=function(e,t){return we.accumulateDelta(t,e)},Ps=function(e){switch(oe(this,Pn,e.data,"f"),e.event){case"thread.run.created":break;case"thread.run.queued":break;case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":oe(this,et,e.data,"f"),x(this,ce,"f")&&(this._emit("toolCallDone",x(this,ce,"f")),oe(this,ce,void 0,"f"));break}};class Fr extends D{create(e,t,n){return this._client.post(`/threads/${e}/messages`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(e,t,n){return this._client.get(`/threads/${e}/messages/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(e,t,n,s){return this._client.post(`/threads/${e}/messages/${t}`,{body:n,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}list(e,t={},n){return ie(t)?this.list(e,{},t):this._client.getAPIList(`/threads/${e}/messages`,Lr,{query:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(e,t,n){return this._client.delete(`/threads/${e}/messages/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}}class Lr extends Ae{}Fr.MessagesPage=Lr;class Br extends D{retrieve(e,t,n,s={},a){return ie(s)?this.retrieve(e,t,n,{},s):this._client.get(`/threads/${e}/runs/${t}/steps/${n}`,{query:s,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}list(e,t,n={},s){return ie(n)?this.list(e,t,{},n):this._client.getAPIList(`/threads/${e}/runs/${t}/steps`,Ur,{query:n,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}}class Ur extends Ae{}Br.RunStepsPage=Ur;class dn extends D{constructor(){super(...arguments),this.steps=new Br(this._client)}create(e,t,n){const{include:s,...a}=t;return this._client.post(`/threads/${e}/runs`,{query:{include:s},body:a,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers},stream:t.stream??!1})}retrieve(e,t,n){return this._client.get(`/threads/${e}/runs/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(e,t,n,s){return this._client.post(`/threads/${e}/runs/${t}`,{body:n,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}list(e,t={},n){return ie(t)?this.list(e,{},t):this._client.getAPIList(`/threads/${e}/runs`,Vr,{query:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}cancel(e,t,n){return this._client.post(`/threads/${e}/runs/${t}/cancel`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}async createAndPoll(e,t,n){const s=await this.create(e,t,n);return await this.poll(e,s.id,n)}createAndStream(e,t,n){return we.createAssistantStream(e,this._client.beta.threads.runs,t,n)}async poll(e,t,n){const s={...n==null?void 0:n.headers,"X-Stainless-Poll-Helper":"true"};for(n!=null&&n.pollIntervalMs&&(s["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const{data:a,response:i}=await this.retrieve(e,t,{...n,headers:{...n==null?void 0:n.headers,...s}}).withResponse();switch(a.status){case"queued":case"in_progress":case"cancelling":let o=5e3;if(n!=null&&n.pollIntervalMs)o=n.pollIntervalMs;else{const c=i.headers.get("openai-poll-after-ms");if(c){const l=parseInt(c);isNaN(l)||(o=l)}}await cn(o);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return a}}}stream(e,t,n){return we.createAssistantStream(e,this._client.beta.threads.runs,t,n)}submitToolOutputs(e,t,n,s){return this._client.post(`/threads/${e}/runs/${t}/submit_tool_outputs`,{body:n,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers},stream:n.stream??!1})}async submitToolOutputsAndPoll(e,t,n,s){const a=await this.submitToolOutputs(e,t,n,s);return await this.poll(e,a.id,s)}submitToolOutputsStream(e,t,n,s){return we.createToolAssistantStream(e,t,this._client.beta.threads.runs,n,s)}}class Vr extends Ae{}dn.RunsPage=Vr;dn.Steps=Br;dn.RunStepsPage=Ur;class Et extends D{constructor(){super(...arguments),this.runs=new dn(this._client),this.messages=new Fr(this._client)}create(e={},t){return ie(e)?this.create({},e):this._client.post("/threads",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}retrieve(e,t){return this._client.get(`/threads/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}update(e,t,n){return this._client.post(`/threads/${e}`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(e,t){return this._client.delete(`/threads/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}createAndRun(e,t){return this._client.post("/threads/runs",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers},stream:e.stream??!1})}async createAndRunPoll(e,t){const n=await this.createAndRun(e,t);return await this.runs.poll(n.thread_id,n.id,t)}createAndRunStream(e,t){return we.createThreadAssistantStream(e,this._client.beta.threads,t)}}Et.Runs=dn;Et.RunsPage=Vr;Et.Messages=Fr;Et.MessagesPage=Lr;const Fc=async r=>{const e=await Promise.allSettled(r),t=e.filter(s=>s.status==="rejected");if(t.length){for(const s of t)console.error(s.reason);throw new Error(`${t.length} promise(s) failed - see the above errors`)}const n=[];for(const s of e)s.status==="fulfilled"&&n.push(s.value);return n};let qr=class extends D{create(e,t,n){return this._client.post(`/vector_stores/${e}/files`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(e,t,n){return this._client.get(`/vector_stores/${e}/files/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}list(e,t={},n){return ie(t)?this.list(e,{},t):this._client.getAPIList(`/vector_stores/${e}/files`,qn,{query:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(e,t,n){return this._client.delete(`/vector_stores/${e}/files/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}async createAndPoll(e,t,n){const s=await this.create(e,t,n);return await this.poll(e,s.id,n)}async poll(e,t,n){const s={...n==null?void 0:n.headers,"X-Stainless-Poll-Helper":"true"};for(n!=null&&n.pollIntervalMs&&(s["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const a=await this.retrieve(e,t,{...n,headers:s}).withResponse(),i=a.data;switch(i.status){case"in_progress":let o=5e3;if(n!=null&&n.pollIntervalMs)o=n.pollIntervalMs;else{const c=a.response.headers.get("openai-poll-after-ms");if(c){const l=parseInt(c);isNaN(l)||(o=l)}}await cn(o);break;case"failed":case"completed":return i}}}async upload(e,t,n){const s=await this._client.files.create({file:t,purpose:"assistants"},n);return this.create(e,{file_id:s.id},n)}async uploadAndPoll(e,t,n){const s=await this.upload(e,t,n);return await this.poll(e,s.id,n)}};class qn extends Ae{}qr.VectorStoreFilesPage=qn;class Ja extends D{create(e,t,n){return this._client.post(`/vector_stores/${e}/file_batches`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(e,t,n){return this._client.get(`/vector_stores/${e}/file_batches/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}cancel(e,t,n){return this._client.post(`/vector_stores/${e}/file_batches/${t}/cancel`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}async createAndPoll(e,t,n){const s=await this.create(e,t);return await this.poll(e,s.id,n)}listFiles(e,t,n={},s){return ie(n)?this.listFiles(e,t,{},n):this._client.getAPIList(`/vector_stores/${e}/file_batches/${t}/files`,qn,{query:n,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}async poll(e,t,n){const s={...n==null?void 0:n.headers,"X-Stainless-Poll-Helper":"true"};for(n!=null&&n.pollIntervalMs&&(s["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const{data:a,response:i}=await this.retrieve(e,t,{...n,headers:s}).withResponse();switch(a.status){case"in_progress":let o=5e3;if(n!=null&&n.pollIntervalMs)o=n.pollIntervalMs;else{const c=i.headers.get("openai-poll-after-ms");if(c){const l=parseInt(c);isNaN(l)||(o=l)}}await cn(o);break;case"failed":case"cancelled":case"completed":return a}}}async uploadAndPoll(e,{files:t,fileIds:n=[]},s){if(t==null||t.length==0)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");const a=(s==null?void 0:s.maxConcurrency)??5,i=Math.min(a,t.length),o=this._client,c=t.values(),l=[...n];async function u(m){for(let _ of m){const S=await o.files.create({file:_,purpose:"assistants"},s);l.push(S.id)}}const d=Array(i).fill(c).map(u);return await Fc(d),await this.createAndPoll(e,{file_ids:l})}}class Rt extends D{constructor(){super(...arguments),this.files=new qr(this._client),this.fileBatches=new Ja(this._client)}create(e,t){return this._client.post("/vector_stores",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}retrieve(e,t){return this._client.get(`/vector_stores/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}update(e,t,n){return this._client.post(`/vector_stores/${e}`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}list(e={},t){return ie(e)?this.list({},e):this._client.getAPIList("/vector_stores",zr,{query:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}del(e,t){return this._client.delete(`/vector_stores/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}}class zr extends Ae{}Rt.VectorStoresPage=zr;Rt.Files=qr;Rt.VectorStoreFilesPage=qn;Rt.FileBatches=Ja;class Xe extends D{constructor(){super(...arguments),this.realtime=new Dr(this._client),this.vectorStores=new Rt(this._client),this.chat=new Ar(this._client),this.assistants=new Mr(this._client),this.threads=new Et(this._client)}}Xe.Realtime=Dr;Xe.VectorStores=Rt;Xe.VectorStoresPage=zr;Xe.Assistants=Mr;Xe.AssistantsPage=jr;Xe.Threads=Et;class Ha extends D{create(e,t){return this._client.post("/completions",{body:e,...t,stream:e.stream??!1})}}class Xa extends D{create(e,t){return this._client.post("/embeddings",{body:e,...t})}}class Wr extends D{create(e,t){return this._client.post("/files",Ct({body:e,...t}))}retrieve(e,t){return this._client.get(`/files/${e}`,t)}list(e={},t){return ie(e)?this.list({},e):this._client.getAPIList("/files",Jr,{query:e,...t})}del(e,t){return this._client.delete(`/files/${e}`,t)}content(e,t){return this._client.get(`/files/${e}/content`,{...t,headers:{Accept:"application/binary",...t==null?void 0:t.headers},__binaryResponse:!0})}retrieveContent(e,t){return this._client.get(`/files/${e}/content`,t)}async waitForProcessing(e,{pollInterval:t=5e3,maxWait:n=30*60*1e3}={}){const s=new Set(["processed","error","deleted"]),a=Date.now();let i=await this.retrieve(e);for(;!i.status||!s.has(i.status);)if(await cn(t),i=await this.retrieve(e),Date.now()-a>n)throw new Or({message:`Giving up on waiting for file ${e} to finish processing after ${n} milliseconds.`});return i}}class Jr extends Ae{}Wr.FileObjectsPage=Jr;class Hr extends D{list(e,t={},n){return ie(t)?this.list(e,{},t):this._client.getAPIList(`/fine_tuning/jobs/${e}/checkpoints`,Xr,{query:t,...n})}}class Xr extends Ae{}Hr.FineTuningJobCheckpointsPage=Xr;class Tt extends D{constructor(){super(...arguments),this.checkpoints=new Hr(this._client)}create(e,t){return this._client.post("/fine_tuning/jobs",{body:e,...t})}retrieve(e,t){return this._client.get(`/fine_tuning/jobs/${e}`,t)}list(e={},t){return ie(e)?this.list({},e):this._client.getAPIList("/fine_tuning/jobs",Kr,{query:e,...t})}cancel(e,t){return this._client.post(`/fine_tuning/jobs/${e}/cancel`,t)}listEvents(e,t={},n){return ie(t)?this.listEvents(e,{},t):this._client.getAPIList(`/fine_tuning/jobs/${e}/events`,Gr,{query:t,...n})}}class Kr extends Ae{}class Gr extends Ae{}Tt.FineTuningJobsPage=Kr;Tt.FineTuningJobEventsPage=Gr;Tt.Checkpoints=Hr;Tt.FineTuningJobCheckpointsPage=Xr;class fn extends D{constructor(){super(...arguments),this.jobs=new Tt(this._client)}}fn.Jobs=Tt;fn.FineTuningJobsPage=Kr;fn.FineTuningJobEventsPage=Gr;class Ka extends D{createVariation(e,t){return this._client.post("/images/variations",Ct({body:e,...t}))}edit(e,t){return this._client.post("/images/edits",Ct({body:e,...t}))}generate(e,t){return this._client.post("/images/generations",{body:e,...t})}}class Qr extends D{retrieve(e,t){return this._client.get(`/models/${e}`,t)}list(e){return this._client.getAPIList("/models",Yr,e)}del(e,t){return this._client.delete(`/models/${e}`,t)}}class Yr extends xc{}Qr.ModelsPage=Yr;class Ga extends D{create(e,t){return this._client.post("/moderations",{body:e,...t})}}class Qa extends D{create(e,t,n){return this._client.post(`/uploads/${e}/parts`,Ct({body:t,...n}))}}class es extends D{constructor(){super(...arguments),this.parts=new Qa(this._client)}create(e,t){return this._client.post("/uploads",{body:e,...t})}cancel(e,t){return this._client.post(`/uploads/${e}/cancel`,t)}complete(e,t,n){return this._client.post(`/uploads/${e}/complete`,{body:t,...n})}}es.Parts=Qa;var Ya;class M extends lc{constructor({baseURL:e=_n("OPENAI_BASE_URL"),apiKey:t=_n("OPENAI_API_KEY"),organization:n=_n("OPENAI_ORG_ID")??null,project:s=_n("OPENAI_PROJECT_ID")??null,...a}={}){if(t===void 0)throw new O("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");const i={apiKey:t,organization:n,project:s,...a,baseURL:e||"https://api.openai.com/v1"};if(!i.dangerouslyAllowBrowser&&bc())throw new O(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

https://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety
`);super({baseURL:i.baseURL,timeout:i.timeout??6e5,httpAgent:i.httpAgent,maxRetries:i.maxRetries,fetch:i.fetch}),this.completions=new Ha(this),this.chat=new Ir(this),this.embeddings=new Xa(this),this.files=new Wr(this),this.images=new Ka(this),this.audio=new ln(this),this.moderations=new Ga(this),this.models=new Qr(this),this.fineTuning=new fn(this),this.beta=new Xe(this),this.batches=new $r(this),this.uploads=new es(this),this._options=i,this.apiKey=t,this.organization=n,this.project=s}defaultQuery(){return this._options.defaultQuery}defaultHeaders(e){return{...super.defaultHeaders(e),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project,...this._options.defaultHeaders}}authHeaders(e){return{Authorization:`Bearer ${this.apiKey}`}}stringifyQuery(e){return Wo(e,{arrayFormat:"brackets"})}}Ya=M;M.OpenAI=Ya;M.DEFAULT_TIMEOUT=6e5;M.OpenAIError=O;M.APIError=Q;M.APIConnectionError=Bn;M.APIConnectionTimeoutError=Or;M.APIUserAbortError=be;M.NotFoundError=ca;M.ConflictError=la;M.RateLimitError=da;M.BadRequestError=aa;M.AuthenticationError=ia;M.InternalServerError=fa;M.PermissionDeniedError=oa;M.UnprocessableEntityError=ua;M.toFile=_a;M.fileFromPath=ra;M.Completions=Ha;M.Chat=Ir;M.Embeddings=Xa;M.Files=Wr;M.FileObjectsPage=Jr;M.Images=Ka;M.Audio=ln;M.Moderations=Ga;M.Models=Qr;M.ModelsPage=Yr;M.FineTuning=fn;M.Beta=Xe;M.Batches=$r;M.BatchesPage=Nr;M.Uploads=es;const Lc=Symbol("Let zodToJsonSchema decide on which parser to use"),Es={name:void 0,$refStrategy:"root",effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",nullableStrategy:"from-target",removeAdditionalStrategy:"passthrough",definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"},Bc=r=>typeof r=="string"?{...Es,basePath:["#"],definitions:{},name:r}:{...Es,basePath:["#"],definitions:{},...r},Pr=r=>"_def"in r?r._def:r;function Uc(r){if(!r)return!0;for(const e in r)return!1;return!0}const Vc=r=>{const e=Bc(r),t=e.name!==void 0?[...e.basePath,e.definitionPath,e.name]:e.basePath;return{...e,currentPath:t,propertyPath:void 0,seenRefs:new Set,seen:new Map(Object.entries(e.definitions).map(([n,s])=>[Pr(s),{def:Pr(s),path:[...e.basePath,e.definitionPath,n],jsonSchema:void 0}]))}};function ei(r,e,t,n){n!=null&&n.errorMessages&&t&&(r.errorMessage={...r.errorMessage,[e]:t})}function U(r,e,t,n,s){r[e]=t,ei(r,e,n,s)}function qc(){return{}}function zc(r,e){var n,s;const t={type:"array"};return((s=(n=r.type)==null?void 0:n._def)==null?void 0:s.typeName)!==h.ZodAny&&(t.items=Z(r.type._def,{...e,currentPath:[...e.currentPath,"items"]})),r.minLength&&U(t,"minItems",r.minLength.value,r.minLength.message,e),r.maxLength&&U(t,"maxItems",r.maxLength.value,r.maxLength.message,e),r.exactLength&&(U(t,"minItems",r.exactLength.value,r.exactLength.message,e),U(t,"maxItems",r.exactLength.value,r.exactLength.message,e)),t}function Wc(r,e){const t={type:"integer",format:"int64"};if(!r.checks)return t;for(const n of r.checks)switch(n.kind){case"min":e.target==="jsonSchema7"?n.inclusive?U(t,"minimum",n.value,n.message,e):U(t,"exclusiveMinimum",n.value,n.message,e):(n.inclusive||(t.exclusiveMinimum=!0),U(t,"minimum",n.value,n.message,e));break;case"max":e.target==="jsonSchema7"?n.inclusive?U(t,"maximum",n.value,n.message,e):U(t,"exclusiveMaximum",n.value,n.message,e):(n.inclusive||(t.exclusiveMaximum=!0),U(t,"maximum",n.value,n.message,e));break;case"multipleOf":U(t,"multipleOf",n.value,n.message,e);break}return t}function Jc(){return{type:"boolean"}}function Hc(r,e){return Z(r.type._def,e)}const Xc=(r,e)=>Z(r.innerType._def,e);function ti(r,e,t){const n=t??e.dateStrategy;if(Array.isArray(n))return{anyOf:n.map((s,a)=>ti(r,e,s))};switch(n){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return Kc(r,e)}}const Kc=(r,e)=>{const t={type:"integer",format:"unix-time"};if(e.target==="openApi3")return t;for(const n of r.checks)switch(n.kind){case"min":U(t,"minimum",n.value,n.message,e);break;case"max":U(t,"maximum",n.value,n.message,e);break}return t};function Gc(r,e){return{...Z(r.innerType._def,e),default:r.defaultValue()}}function Qc(r,e,t){return e.effectStrategy==="input"?Z(r.schema._def,e,t):{}}function Yc(r){return{type:"string",enum:[...r.values]}}const el=r=>"type"in r&&r.type==="string"?!1:"allOf"in r;function tl(r,e){const t=[Z(r.left._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),Z(r.right._def,{...e,currentPath:[...e.currentPath,"allOf","1"]})].filter(a=>!!a);let n=e.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0;const s=[];return t.forEach(a=>{if(el(a))s.push(...a.allOf),a.unevaluatedProperties===void 0&&(n=void 0);else{let i=a;if("additionalProperties"in a&&a.additionalProperties===!1){const{additionalProperties:o,...c}=a;i=c}else n=void 0;s.push(i)}}),s.length?{allOf:s,...n}:void 0}function nl(r,e){const t=typeof r.value;return t!=="bigint"&&t!=="number"&&t!=="boolean"&&t!=="string"?{type:Array.isArray(r.value)?"array":"object"}:e.target==="openApi3"?{type:t==="bigint"?"integer":t,enum:[r.value]}:{type:t==="bigint"?"integer":t,const:r.value}}let or;const Qe={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(or===void 0&&(or=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),or),base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/};function ni(r,e){const t={type:"string"};function n(s){return e.patternStrategy==="escape"?rl(s):s}if(r.checks)for(const s of r.checks)switch(s.kind){case"min":U(t,"minLength",typeof t.minLength=="number"?Math.max(t.minLength,s.value):s.value,s.message,e);break;case"max":U(t,"maxLength",typeof t.maxLength=="number"?Math.min(t.maxLength,s.value):s.value,s.message,e);break;case"email":switch(e.emailStrategy){case"format:email":pe(t,"email",s.message,e);break;case"format:idn-email":pe(t,"idn-email",s.message,e);break;case"pattern:zod":ge(t,Qe.email,s.message,e);break}break;case"url":pe(t,"uri",s.message,e);break;case"uuid":pe(t,"uuid",s.message,e);break;case"regex":ge(t,s.regex,s.message,e);break;case"cuid":ge(t,Qe.cuid,s.message,e);break;case"cuid2":ge(t,Qe.cuid2,s.message,e);break;case"startsWith":ge(t,RegExp(`^${n(s.value)}`),s.message,e);break;case"endsWith":ge(t,RegExp(`${n(s.value)}$`),s.message,e);break;case"datetime":pe(t,"date-time",s.message,e);break;case"date":pe(t,"date",s.message,e);break;case"time":pe(t,"time",s.message,e);break;case"duration":pe(t,"duration",s.message,e);break;case"length":U(t,"minLength",typeof t.minLength=="number"?Math.max(t.minLength,s.value):s.value,s.message,e),U(t,"maxLength",typeof t.maxLength=="number"?Math.min(t.maxLength,s.value):s.value,s.message,e);break;case"includes":{ge(t,RegExp(n(s.value)),s.message,e);break}case"ip":{s.version!=="v6"&&pe(t,"ipv4",s.message,e),s.version!=="v4"&&pe(t,"ipv6",s.message,e);break}case"emoji":ge(t,Qe.emoji,s.message,e);break;case"ulid":{ge(t,Qe.ulid,s.message,e);break}case"base64":{switch(e.base64Strategy){case"format:binary":{pe(t,"binary",s.message,e);break}case"contentEncoding:base64":{U(t,"contentEncoding","base64",s.message,e);break}case"pattern:zod":{ge(t,Qe.base64,s.message,e);break}}break}case"nanoid":ge(t,Qe.nanoid,s.message,e)}return t}const rl=r=>Array.from(r).map(e=>/[a-zA-Z0-9]/.test(e)?e:`\\${e}`).join(""),pe=(r,e,t,n)=>{var s;r.format||(s=r.anyOf)!=null&&s.some(a=>a.format)?(r.anyOf||(r.anyOf=[]),r.format&&(r.anyOf.push({format:r.format,...r.errorMessage&&n.errorMessages&&{errorMessage:{format:r.errorMessage.format}}}),delete r.format,r.errorMessage&&(delete r.errorMessage.format,Object.keys(r.errorMessage).length===0&&delete r.errorMessage)),r.anyOf.push({format:e,...t&&n.errorMessages&&{errorMessage:{format:t}}})):U(r,"format",e,t,n)},ge=(r,e,t,n)=>{var s;r.pattern||(s=r.allOf)!=null&&s.some(a=>a.pattern)?(r.allOf||(r.allOf=[]),r.pattern&&(r.allOf.push({pattern:r.pattern,...r.errorMessage&&n.errorMessages&&{errorMessage:{pattern:r.errorMessage.pattern}}}),delete r.pattern,r.errorMessage&&(delete r.errorMessage.pattern,Object.keys(r.errorMessage).length===0&&delete r.errorMessage)),r.allOf.push({pattern:Rs(e,n),...t&&n.errorMessages&&{errorMessage:{pattern:t}}})):U(r,"pattern",Rs(e,n),t,n)},Rs=(r,e)=>{var l;const t=typeof r=="function"?r():r;if(!e.applyRegexFlags||!t.flags)return t.source;const n={i:t.flags.includes("i"),m:t.flags.includes("m"),s:t.flags.includes("s")},s=n.i?t.source.toLowerCase():t.source;let a="",i=!1,o=!1,c=!1;for(let u=0;u<s.length;u++){if(i){a+=s[u],i=!1;continue}if(n.i){if(o){if(s[u].match(/[a-z]/)){c?(a+=s[u],a+=`${s[u-2]}-${s[u]}`.toUpperCase(),c=!1):s[u+1]==="-"&&((l=s[u+2])!=null&&l.match(/[a-z]/))?(a+=s[u],c=!0):a+=`${s[u]}${s[u].toUpperCase()}`;continue}}else if(s[u].match(/[a-z]/)){a+=`[${s[u]}${s[u].toUpperCase()}]`;continue}}if(n.m){if(s[u]==="^"){a+=`(^|(?<=[\r
]))`;continue}else if(s[u]==="$"){a+=`($|(?=[\r
]))`;continue}}if(n.s&&s[u]==="."){a+=o?`${s[u]}\r
`:`[${s[u]}\r
]`;continue}a+=s[u],s[u]==="\\"?i=!0:o&&s[u]==="]"?o=!1:!o&&s[u]==="["&&(o=!0)}try{const u=new RegExp(a)}catch{return console.warn(`Could not convert regex pattern at ${e.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),t.source}return a};function ri(r,e){var n,s,a,i;if(e.target==="openApi3"&&((n=r.keyType)==null?void 0:n._def.typeName)===h.ZodEnum)return{type:"object",required:r.keyType._def.values,properties:r.keyType._def.values.reduce((o,c)=>({...o,[c]:Z(r.valueType._def,{...e,currentPath:[...e.currentPath,"properties",c]})??{}}),{}),additionalProperties:!1};const t={type:"object",additionalProperties:Z(r.valueType._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??{}};if(e.target==="openApi3")return t;if(((s=r.keyType)==null?void 0:s._def.typeName)===h.ZodString&&((a=r.keyType._def.checks)!=null&&a.length)){const o=Object.entries(ni(r.keyType._def,e)).reduce((c,[l,u])=>l==="type"?c:{...c,[l]:u},{});return{...t,propertyNames:o}}else if(((i=r.keyType)==null?void 0:i._def.typeName)===h.ZodEnum)return{...t,propertyNames:{enum:r.keyType._def.values}};return t}function sl(r,e){if(e.mapStrategy==="record")return ri(r,e);const t=Z(r.keyType._def,{...e,currentPath:[...e.currentPath,"items","items","0"]})||{},n=Z(r.valueType._def,{...e,currentPath:[...e.currentPath,"items","items","1"]})||{};return{type:"array",maxItems:125,items:{type:"array",items:[t,n],minItems:2,maxItems:2}}}function al(r){const e=r.values,n=Object.keys(r.values).filter(a=>typeof e[e[a]]!="number").map(a=>e[a]),s=Array.from(new Set(n.map(a=>typeof a)));return{type:s.length===1?s[0]==="string"?"string":"number":["string","number"],enum:n}}function il(){return{not:{}}}function ol(r){return r.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}const Fn={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function cl(r,e){if(e.target==="openApi3")return Ts(r,e);const t=r.options instanceof Map?Array.from(r.options.values()):r.options;if(t.every(n=>n._def.typeName in Fn&&(!n._def.checks||!n._def.checks.length))){const n=t.reduce((s,a)=>{const i=Fn[a._def.typeName];return i&&!s.includes(i)?[...s,i]:s},[]);return{type:n.length>1?n:n[0]}}else if(t.every(n=>n._def.typeName==="ZodLiteral"&&!n.description)){const n=t.reduce((s,a)=>{const i=typeof a._def.value;switch(i){case"string":case"number":case"boolean":return[...s,i];case"bigint":return[...s,"integer"];case"object":if(a._def.value===null)return[...s,"null"];case"symbol":case"undefined":case"function":default:return s}},[]);if(n.length===t.length){const s=n.filter((a,i,o)=>o.indexOf(a)===i);return{type:s.length>1?s:s[0],enum:t.reduce((a,i)=>a.includes(i._def.value)?a:[...a,i._def.value],[])}}}else if(t.every(n=>n._def.typeName==="ZodEnum"))return{type:"string",enum:t.reduce((n,s)=>[...n,...s._def.values.filter(a=>!n.includes(a))],[])};return Ts(r,e)}const Ts=(r,e)=>{const t=(r.options instanceof Map?Array.from(r.options.values()):r.options).map((n,s)=>Z(n._def,{...e,currentPath:[...e.currentPath,"anyOf",`${s}`]})).filter(n=>!!n&&(!e.strictUnions||typeof n=="object"&&Object.keys(n).length>0));return t.length?{anyOf:t}:void 0};function ll(r,e){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(r.innerType._def.typeName)&&(!r.innerType._def.checks||!r.innerType._def.checks.length))return e.target==="openApi3"||e.nullableStrategy==="property"?{type:Fn[r.innerType._def.typeName],nullable:!0}:{type:[Fn[r.innerType._def.typeName],"null"]};if(e.target==="openApi3"){const n=Z(r.innerType._def,{...e,currentPath:[...e.currentPath]});return n&&"$ref"in n?{allOf:[n],nullable:!0}:n&&{...n,nullable:!0}}const t=Z(r.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","0"]});return t&&{anyOf:[t,{type:"null"}]}}function ul(r,e){const t={type:"number"};if(!r.checks)return t;for(const n of r.checks)switch(n.kind){case"int":t.type="integer",ei(t,"type",n.message,e);break;case"min":e.target==="jsonSchema7"?n.inclusive?U(t,"minimum",n.value,n.message,e):U(t,"exclusiveMinimum",n.value,n.message,e):(n.inclusive||(t.exclusiveMinimum=!0),U(t,"minimum",n.value,n.message,e));break;case"max":e.target==="jsonSchema7"?n.inclusive?U(t,"maximum",n.value,n.message,e):U(t,"exclusiveMaximum",n.value,n.message,e):(n.inclusive||(t.exclusiveMaximum=!0),U(t,"maximum",n.value,n.message,e));break;case"multipleOf":U(t,"multipleOf",n.value,n.message,e);break}return t}function dl(r,e){return e.removeAdditionalStrategy==="strict"?r.catchall._def.typeName==="ZodNever"?r.unknownKeys!=="strict":Z(r.catchall._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??!0:r.catchall._def.typeName==="ZodNever"?r.unknownKeys==="passthrough":Z(r.catchall._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??!0}function fl(r,e){const t={type:"object",...Object.entries(r.shape()).reduce((n,[s,a])=>{if(a===void 0||a._def===void 0)return n;const i=Z(a._def,{...e,currentPath:[...e.currentPath,"properties",s],propertyPath:[...e.currentPath,"properties",s]});return i===void 0?n:{properties:{...n.properties,[s]:i},required:a.isOptional()&&!e.openaiStrictMode?n.required:[...n.required,s]}},{properties:{},required:[]}),additionalProperties:dl(r,e)};return t.required.length||delete t.required,t}const hl=(r,e)=>{var n;if(e.currentPath.toString()===((n=e.propertyPath)==null?void 0:n.toString()))return Z(r.innerType._def,e);const t=Z(r.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","1"]});return t?{anyOf:[{not:{}},t]}:{}},ml=(r,e)=>{if(e.pipeStrategy==="input")return Z(r.in._def,e);if(e.pipeStrategy==="output")return Z(r.out._def,e);const t=Z(r.in._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),n=Z(r.out._def,{...e,currentPath:[...e.currentPath,"allOf",t?"1":"0"]});return{allOf:[t,n].filter(s=>s!==void 0)}};function pl(r,e){return Z(r.type._def,e)}function gl(r,e){const n={type:"array",uniqueItems:!0,items:Z(r.valueType._def,{...e,currentPath:[...e.currentPath,"items"]})};return r.minSize&&U(n,"minItems",r.minSize.value,r.minSize.message,e),r.maxSize&&U(n,"maxItems",r.maxSize.value,r.maxSize.message,e),n}function yl(r,e){return r.rest?{type:"array",minItems:r.items.length,items:r.items.map((t,n)=>Z(t._def,{...e,currentPath:[...e.currentPath,"items",`${n}`]})).reduce((t,n)=>n===void 0?t:[...t,n],[]),additionalItems:Z(r.rest._def,{...e,currentPath:[...e.currentPath,"additionalItems"]})}:{type:"array",minItems:r.items.length,maxItems:r.items.length,items:r.items.map((t,n)=>Z(t._def,{...e,currentPath:[...e.currentPath,"items",`${n}`]})).reduce((t,n)=>n===void 0?t:[...t,n],[])}}function _l(){return{not:{}}}function vl(){return{}}const bl=(r,e)=>Z(r.innerType._def,e);function Z(r,e,t=!1){var i;const n=e.seen.get(r);if(e.override){const o=(i=e.override)==null?void 0:i.call(e,r,e,n,t);if(o!==Lc)return o}if(n&&!t){const o=wl(n,e);if(o!==void 0)return"$ref"in o&&e.seenRefs.add(o.$ref),o}const s={def:r,path:e.currentPath,jsonSchema:void 0};e.seen.set(r,s);const a=kl(r,r.typeName,e,t);return a&&Sl(r,e,a),s.jsonSchema=a,a}const wl=(r,e)=>{switch(e.$refStrategy){case"root":return{$ref:r.path.join("/")};case"extract-to-root":const t=r.path.slice(e.basePath.length+1).join("_");return t!==e.name&&e.nameStrategy==="duplicate-ref"&&(e.definitions[t]=r.def),{$ref:[...e.basePath,e.definitionPath,t].join("/")};case"relative":return{$ref:xl(e.currentPath,r.path)};case"none":case"seen":return r.path.length<e.currentPath.length&&r.path.every((n,s)=>e.currentPath[s]===n)?(console.warn(`Recursive reference detected at ${e.currentPath.join("/")}! Defaulting to any`),{}):e.$refStrategy==="seen"?{}:void 0}},xl=(r,e)=>{let t=0;for(;t<r.length&&t<e.length&&r[t]===e[t];t++);return[(r.length-t).toString(),...e.slice(t)].join("/")},kl=(r,e,t,n)=>{switch(e){case h.ZodString:return ni(r,t);case h.ZodNumber:return ul(r,t);case h.ZodObject:return fl(r,t);case h.ZodBigInt:return Wc(r,t);case h.ZodBoolean:return Jc();case h.ZodDate:return ti(r,t);case h.ZodUndefined:return _l();case h.ZodNull:return ol(t);case h.ZodArray:return zc(r,t);case h.ZodUnion:case h.ZodDiscriminatedUnion:return cl(r,t);case h.ZodIntersection:return tl(r,t);case h.ZodTuple:return yl(r,t);case h.ZodRecord:return ri(r,t);case h.ZodLiteral:return nl(r,t);case h.ZodEnum:return Yc(r);case h.ZodNativeEnum:return al(r);case h.ZodNullable:return ll(r,t);case h.ZodOptional:return hl(r,t);case h.ZodMap:return sl(r,t);case h.ZodSet:return gl(r,t);case h.ZodLazy:return Z(r.getter()._def,t);case h.ZodPromise:return pl(r,t);case h.ZodNaN:case h.ZodNever:return il();case h.ZodEffects:return Qc(r,t,n);case h.ZodAny:return qc();case h.ZodUnknown:return vl();case h.ZodDefault:return Gc(r,t);case h.ZodBranded:return Hc(r,t);case h.ZodReadonly:return bl(r,t);case h.ZodCatch:return Xc(r,t);case h.ZodPipeline:return ml(r,t);case h.ZodFunction:case h.ZodVoid:case h.ZodSymbol:return;default:return(s=>{})()}},Sl=(r,e,t)=>(r.description&&(t.description=r.description,e.markdownDescription&&(t.markdownDescription=r.description)),t),Al=(r,e)=>{const t=Vc(e),n=typeof e=="string"?e:(e==null?void 0:e.nameStrategy)==="title"||e==null?void 0:e.name,s=Z(r._def,n===void 0?t:{...t,currentPath:[...t.basePath,t.definitionPath,n]},!1)??{},a=typeof e=="object"&&e.name!==void 0&&e.nameStrategy==="title"?e.name:void 0;a!==void 0&&(s.title=a);const i=(()=>{if(Uc(t.definitions))return;const c={},l=new Set;for(let u=0;u<500;u++){const d=Object.entries(t.definitions).filter(([m])=>!l.has(m));if(d.length===0)break;for(const[m,_]of d)c[m]=Z(Pr(_),{...t,currentPath:[...t.basePath,t.definitionPath,m]},!0)??{},l.add(m)}return c})(),o=n===void 0?i?{...s,[t.definitionPath]:i}:s:t.nameStrategy==="duplicate-ref"?{...s,...i||t.seenRefs.size?{[t.definitionPath]:{...i,...t.seenRefs.size?{[n]:s}:void 0}}:void 0}:{$ref:[...t.$refStrategy==="relative"?[]:t.basePath,t.definitionPath,n].join("/"),[t.definitionPath]:{...i,[n]:s}};return t.target==="jsonSchema7"?o.$schema="http://json-schema.org/draft-07/schema#":t.target==="jsonSchema2019-09"&&(o.$schema="https://json-schema.org/draft/2019-09/schema#"),o};function Cl(r,e){return Al(r,{openaiStrictMode:!0,name:e.name,nameStrategy:"duplicate-ref",$refStrategy:"extract-to-root",nullableStrategy:"property"})}function Pl(r,e,t){return kc({type:"json_schema",json_schema:{...t,name:e,strict:!0,schema:Cl(r,{name:e})}},n=>r.parse(JSON.parse(n)))}let cr;const Os=[];async function El(r){var n;if(!cr){const s="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";cr=new M({apiKey:s,dangerouslyAllowBrowser:!0})}Os.push({role:"user",content:r.content});const e=await cr.chat.completions.create({model:"gpt-4o-mini",store:!1,messages:Os,response_format:Pl(r.format,"advice")}),t=e.choices.shift();if(t){const s=t.message.content;s&&((n=r.handler)==null||n.call(r,JSON.parse(s)))}return e}const si={prompt:El};/*!
 * mustache.js - Logic-less {{mustache}} templates with JavaScript
 * http://github.com/janl/mustache.js
 */var Rl=Object.prototype.toString,Ot=Array.isArray||function(e){return Rl.call(e)==="[object Array]"};function ts(r){return typeof r=="function"}function Tl(r){return Ot(r)?"array":typeof r}function lr(r){return r.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function Is(r,e){return r!=null&&typeof r=="object"&&e in r}function Ol(r,e){return r!=null&&typeof r!="object"&&r.hasOwnProperty&&r.hasOwnProperty(e)}var Il=RegExp.prototype.test;function $l(r,e){return Il.call(r,e)}var Nl=/\S/;function Ml(r){return!$l(Nl,r)}var jl={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};function Zl(r){return String(r).replace(/[&<>"'`=\/]/g,function(t){return jl[t]})}var Dl=/\s*/,Fl=/\s+/,$s=/\s*=/,Ll=/\s*\}/,Bl=/#|\^|\/|>|\{|&|=|!/;function Ul(r,e){if(!r)return[];var t=!1,n=[],s=[],a=[],i=!1,o=!1,c="",l=0;function u(){if(i&&!o)for(;a.length;)delete s[a.pop()];else a=[];i=!1,o=!1}var d,m,_;function S(I){if(typeof I=="string"&&(I=I.split(Fl,2)),!Ot(I)||I.length!==2)throw new Error("Invalid tags: "+I);d=new RegExp(lr(I[0])+"\\s*"),m=new RegExp("\\s*"+lr(I[1])),_=new RegExp("\\s*"+lr("}"+I[1]))}S(e||he.tags);for(var g=new hn(r),b,$,y,P,k,F;!g.eos();){if(b=g.pos,y=g.scanUntil(d),y)for(var T=0,R=y.length;T<R;++T)P=y.charAt(T),Ml(P)?(a.push(s.length),c+=P):(o=!0,t=!0,c+=" "),s.push(["text",P,b,b+1]),b+=1,P===`
`&&(u(),c="",l=0,t=!1);if(!g.scan(d))break;if(i=!0,$=g.scan(Bl)||"name",g.scan(Dl),$==="="?(y=g.scanUntil($s),g.scan($s),g.scanUntil(m)):$==="{"?(y=g.scanUntil(_),g.scan(Ll),g.scanUntil(m),$="&"):y=g.scanUntil(m),!g.scan(m))throw new Error("Unclosed tag at "+g.pos);if($==">"?k=[$,y,b,g.pos,c,l,t]:k=[$,y,b,g.pos],l++,s.push(k),$==="#"||$==="^")n.push(k);else if($==="/"){if(F=n.pop(),!F)throw new Error('Unopened section "'+y+'" at '+b);if(F[1]!==y)throw new Error('Unclosed section "'+F[1]+'" at '+b)}else $==="name"||$==="{"||$==="&"?o=!0:$==="="&&S(y)}if(u(),F=n.pop(),F)throw new Error('Unclosed section "'+F[1]+'" at '+g.pos);return ql(Vl(s))}function Vl(r){for(var e=[],t,n,s=0,a=r.length;s<a;++s)t=r[s],t&&(t[0]==="text"&&n&&n[0]==="text"?(n[1]+=t[1],n[3]=t[3]):(e.push(t),n=t));return e}function ql(r){for(var e=[],t=e,n=[],s,a,i=0,o=r.length;i<o;++i)switch(s=r[i],s[0]){case"#":case"^":t.push(s),n.push(s),t=s[4]=[];break;case"/":a=n.pop(),a[5]=s[2],t=n.length>0?n[n.length-1][4]:e;break;default:t.push(s)}return e}function hn(r){this.string=r,this.tail=r,this.pos=0}hn.prototype.eos=function(){return this.tail===""};hn.prototype.scan=function(e){var t=this.tail.match(e);if(!t||t.index!==0)return"";var n=t[0];return this.tail=this.tail.substring(n.length),this.pos+=n.length,n};hn.prototype.scanUntil=function(e){var t=this.tail.search(e),n;switch(t){case-1:n=this.tail,this.tail="";break;case 0:n="";break;default:n=this.tail.substring(0,t),this.tail=this.tail.substring(t)}return this.pos+=n.length,n};function Pt(r,e){this.view=r,this.cache={".":this.view},this.parent=e}Pt.prototype.push=function(e){return new Pt(e,this)};Pt.prototype.lookup=function(e){var t=this.cache,n;if(t.hasOwnProperty(e))n=t[e];else{for(var s=this,a,i,o,c=!1;s;){if(e.indexOf(".")>0)for(a=s.view,i=e.split("."),o=0;a!=null&&o<i.length;)o===i.length-1&&(c=Is(a,i[o])||Ol(a,i[o])),a=a[i[o++]];else a=s.view[e],c=Is(s.view,e);if(c){n=a;break}s=s.parent}t[e]=n}return ts(n)&&(n=n.call(this.view)),n};function ne(){this.templateCache={_cache:{},set:function(e,t){this._cache[e]=t},get:function(e){return this._cache[e]},clear:function(){this._cache={}}}}ne.prototype.clearCache=function(){typeof this.templateCache<"u"&&this.templateCache.clear()};ne.prototype.parse=function(e,t){var n=this.templateCache,s=e+":"+(t||he.tags).join(":"),a=typeof n<"u",i=a?n.get(s):void 0;return i==null&&(i=Ul(e,t),a&&n.set(s,i)),i};ne.prototype.render=function(e,t,n,s){var a=this.getConfigTags(s),i=this.parse(e,a),o=t instanceof Pt?t:new Pt(t,void 0);return this.renderTokens(i,o,n,e,s)};ne.prototype.renderTokens=function(e,t,n,s,a){for(var i="",o,c,l,u=0,d=e.length;u<d;++u)l=void 0,o=e[u],c=o[0],c==="#"?l=this.renderSection(o,t,n,s,a):c==="^"?l=this.renderInverted(o,t,n,s,a):c===">"?l=this.renderPartial(o,t,n,a):c==="&"?l=this.unescapedValue(o,t):c==="name"?l=this.escapedValue(o,t,a):c==="text"&&(l=this.rawValue(o)),l!==void 0&&(i+=l);return i};ne.prototype.renderSection=function(e,t,n,s,a){var i=this,o="",c=t.lookup(e[1]);function l(m){return i.render(m,t,n,a)}if(c){if(Ot(c))for(var u=0,d=c.length;u<d;++u)o+=this.renderTokens(e[4],t.push(c[u]),n,s,a);else if(typeof c=="object"||typeof c=="string"||typeof c=="number")o+=this.renderTokens(e[4],t.push(c),n,s,a);else if(ts(c)){if(typeof s!="string")throw new Error("Cannot use higher-order sections without the original template");c=c.call(t.view,s.slice(e[3],e[5]),l),c!=null&&(o+=c)}else o+=this.renderTokens(e[4],t,n,s,a);return o}};ne.prototype.renderInverted=function(e,t,n,s,a){var i=t.lookup(e[1]);if(!i||Ot(i)&&i.length===0)return this.renderTokens(e[4],t,n,s,a)};ne.prototype.indentPartial=function(e,t,n){for(var s=t.replace(/[^ \t]/g,""),a=e.split(`
`),i=0;i<a.length;i++)a[i].length&&(i>0||!n)&&(a[i]=s+a[i]);return a.join(`
`)};ne.prototype.renderPartial=function(e,t,n,s){if(n){var a=this.getConfigTags(s),i=ts(n)?n(e[1]):n[e[1]];if(i!=null){var o=e[6],c=e[5],l=e[4],u=i;c==0&&l&&(u=this.indentPartial(i,l,o));var d=this.parse(u,a);return this.renderTokens(d,t,n,u,s)}}};ne.prototype.unescapedValue=function(e,t){var n=t.lookup(e[1]);if(n!=null)return n};ne.prototype.escapedValue=function(e,t,n){var s=this.getConfigEscape(n)||he.escape,a=t.lookup(e[1]);if(a!=null)return typeof a=="number"&&s===he.escape?String(a):s(a)};ne.prototype.rawValue=function(e){return e[1]};ne.prototype.getConfigTags=function(e){return Ot(e)?e:e&&typeof e=="object"?e.tags:void 0};ne.prototype.getConfigEscape=function(e){if(e&&typeof e=="object"&&!Ot(e))return e.escape};var he={name:"mustache.js",version:"4.2.0",tags:["{{","}}"],clearCache:void 0,escape:void 0,parse:void 0,render:void 0,Scanner:void 0,Context:void 0,Writer:void 0,set templateCache(r){an.templateCache=r},get templateCache(){return an.templateCache}},an=new ne;he.clearCache=function(){return an.clearCache()};he.parse=function(e,t){return an.parse(e,t)};he.render=function(e,t,n,s){if(typeof e!="string")throw new TypeError('Invalid template! Template should be a "string" but "'+Tl(e)+'" was given as the first argument for mustache#render(template, view, partials)');return an.render(e,t,n,s)};he.escape=Zl;he.Scanner=hn;he.Context=Pt;he.Writer=ne;const zl=()=>Wl,Wl={content:"You are a trained medical assistant attending to a patient. Enquire on what problems that they might be having and provide a list of symptoms for them to choose from.",role:"developer",format:Fe.object({greeting:Fe.string(),symptoms:Fe.array(Fe.string())}),handler:Xl},Jl={content:`Given the following symptoms: {{symptoms}}
 Attempt to provide what underlying medical issues may be causing them`,role:"developer",format:Fe.object({causes:Fe.array(Fe.string()),recommendations:Fe.array(Fe.string())}),handler:Hl};function Hl(r){const e=qe(),t=[];let n=`We're sorry to hear that. Here are a few possible causes for the symptoms you're experiencing: 

`;for(const s of r.causes)n+=`*	${s}
`;t.push({content:n,kind:"message"}),n=`Here are some recommendations you should consider: 

`,e.recommendations.set(r.recommendations.join(`
`));for(const s of r.recommendations)n+=`*	${s}
`;t.push({content:n,kind:"message"}),t.push({content:"Still need more help?",kind:"message"}),t.push({content:"Talk to an operator",kind:"option",handler:()=>{qe().currentRoom.set("waitingrm"),as("call")}}),t.push({content:"End session",kind:"option",handler:()=>{const s=qe();s.selection.set(""),s.messages.set([]),s.responses.set([]),as("/")}}),e.responses.set(t),e.loading.set(!1),e.canType.set(!1)}function Xl(r){const e=qe(),{responses:t,loading:n,canType:s}=e,a=[];if(!(r.symptoms.length<=0)){for(const i of r.symptoms)a.push({content:i,kind:"checkbox",checked:!1});a.push({content:"Submit",kind:"option",handler:()=>{const i=qe();i.loading.set(!0);const o=Er(i.responses).filter(l=>l.checked==!0).map(l=>l.content);if(o.length<=0)return;i.userInput.set(o.join(","));const c={...Jl};c.content=he.render(c.content,{symptoms:o}),si.prompt(c),i.responses.set([])}}),t.set(a),n.set(!1),s.set(!0)}}function Kl(r){const e=Ds(),t=e.findIndex(l=>l.name==r);if(t<0)return;const n=qe(),{selectionLabel:s,messages:a,loading:i,selection:o}=n;s.set(e[t].label);let c=Er(a);switch(r){case"health":c.push({content:`What symptoms are you experiencing?

Please select an option or simply type out your symptoms.`});break}switch(o.set(r),a.set(c),i.set(!0),r){case"health":si.prompt(zl());break;default:o.set(""),i.set(!1);break}}const Gl={select:Kl};function Ql(r,e){var t;(t=e())==null||t(r)}var Yl=Se('<sl-button><div class="instrument-sans text-sm text-white"><div class="flex"><p class="my-auto"> </p> <div class="my-auto ml-auto text-3xl"><i class="bx bxs-chevron-right"></i></div></div></div></sl-button>',2);function eu(r,e){Ns(e,!0);let t=Zs(e,"onclick",3,c=>{});var n=Yl();n.__click=[Ql,t],ae(n,"class","link-message my-2 w-full svelte-19ziov7");var s=J(n),a=J(s),i=J(a),o=J(i,!0);z(i),hi(2),z(a),z(s),z(n),Ze(()=>pt(o,e.content)),le(r,n),Ms()}Rr(["click"]);var tu=(r,e,t)=>e(re(t).name),nu=Se('<sl-button><p class="flex-1 text-left font-bold svelte-195ysuq"> </p></sl-button>',2),ru=Se('<div class="voxx-main m-auto svelte-195ysuq" style="width: 90%;"><div class=" flex flex-col svelte-195ysuq"><img src="lifebuoy-help-svgrepo-com.svg" alt="app-logo" class="app-logo svelte-195ysuq"> <h2 class="instrument-sans-bold app-hd mx-auto svelte-195ysuq">Hello, what is your emergency?</h2> <div class="btn-panel mt-4 svelte-195ysuq"></div></div></div>'),su=Se('<div class="chat-message instrument-sans my-2 p-4 text-sm whitespace-break-spaces svelte-195ysuq"><p class="svelte-195ysuq"> </p></div>'),au=Se('<div class="chat-message instrument-sans my-2 p-4 text-sm whitespace-break-spaces svelte-195ysuq"><p class="svelte-195ysuq"> </p></div>'),iu=Se('<div class="mx-auto mt-10 flex svelte-195ysuq"><div class="dot-loader mx-auto svelte-195ysuq"></div></div>'),ou=(r,e)=>{var t;return js(e,vi((t=r.target)==null?void 0:t.value))},cu=Se('<div class="voxx-main voxx-main-2 flex w-full flex-col p-4 svelte-195ysuq"><div class="svelte-195ysuq"><div class="svelte-195ysuq"><div class="flex svelte-195ysuq"><img src="lifebuoy-help-svgrepo-com.svg" alt="app-logo" class="app-logo2 svelte-195ysuq"> <div class="my-auto ml-2 svelte-195ysuq"><h1 class="my-0 text-xl font-bold text-red-500 svelte-195ysuq">VOXX</h1> <h4 class="my-0 text-xl svelte-195ysuq">Emergency Services</h4></div></div></div> <div class="emerg-hd mt-2 mb-10 svelte-195ysuq"><p class="flex-1 text-left svelte-195ysuq"> </p></div> <!> <!> <!></div></div> <div class="chat-panel mt-auto flex svelte-195ysuq"><sl-input></sl-input> <sl-button><i class="bx bx-send svelte-195ysuq"></i></sl-button></div>',3),lu=Se('<div class="voxx-app m-auto flex h-full w-full svelte-195ysuq"><!></div>');function Tu(r,e){Ns(e,!0);const[t,n]=gi(),s=()=>lt(u,"$selection",t),a=()=>lt(d,"$selectionLabel",t),i=()=>lt(m,"$messages",t),o=()=>lt(_,"$responses",t),c=()=>lt(S,"$loading",t),l=()=>lt(g,"$canType",t),{selection:u,selectionLabel:d,messages:m,responses:_,loading:S,canType:g}=qe();let b=pi("");mi(()=>{qe().resume()});const $=Ds();function y(I){Gl.select(I)}function P(){if(re(b)=="")return;const I=[];for(const L of Er(_))L.kind!="checkbox"&&I.push({checked:!0,content:re(b),kind:"checkbox"}),I.push(L);js(b,""),_.set(I)}var k=lu(),F=J(k);{var T=I=>{var L=ru(),B=J(L),j=Ve(J(B),4);Hn(j,21,()=>$,Xn,(de,$e)=>{var me=nu();ae(me,"size","medium"),ae(me,"variant","neutral"),ae(me,"class","emerg-btn my-auto svelte-195ysuq"),me.__click=[tu,y,$e];var Be=J(me),mn=J(Be,!0);z(Be),z(me),Ze(()=>pt(mn,re($e).label)),le(de,me)}),z(j),z(B),z(L),le(I,L)},R=I=>{var L=cu(),B=Jn(L),j=J(B),de=Ve(J(j),2),$e=J(de),me=J($e,!0);z($e),z(de);var Be=Ve(de,2);Hn(Be,1,i,Xn,(Ge,fe)=>{var pn=su(),It=J(pn),zn=J(It,!0);z(It),z(pn),Ze(()=>pt(zn,re(fe).content)),le(Ge,pn)});var mn=Ve(Be,2);Hn(mn,1,o,Xn,(Ge,fe,pn)=>{var It=ss(),zn=Jn(It);{var oi=ot=>{Ci(ot,{get content(){return re(fe).content},get isChecked(){return re(fe).checked},set isChecked(gn){re(fe).checked=gn,yi(t,"$responses")}})},ci=ot=>{var gn=ss(),li=Jn(gn);{var ui=ct=>{eu(ct,{get content(){return re(fe).content},get onclick(){return re(fe).handler}})},di=ct=>{var Wn=au(),rs=J(Wn),fi=J(rs,!0);z(rs),z(Wn),Ze(()=>pt(fi,re(fe).content)),le(ct,Wn)};$t(li,ct=>{re(fe).kind=="option"?ct(ui):ct(di,!1)},!0)}le(ot,gn)};$t(zn,ot=>{re(fe).kind==="checkbox"?ot(oi):ot(ci,!1)})}le(Ge,It)});var ai=Ve(mn,2);{var ii=Ge=>{var fe=iu();le(Ge,fe)};$t(ai,Ge=>{c()&&Ge(ii)})}z(j),z(B);var ns=Ve(B,2),Ke=J(ns);ae(Ke,"class","chat-input my-auto mr-2 flex-1 svelte-195ysuq"),ae(Ke,"placeholder","Type something..."),Ze(()=>ae(Ke,"value",re(b))),Ke.__input=[ou,b],Ze(()=>ae(Ke,"disabled",!l()));var it=Ve(Ke,2);ae(it,"size","medium"),ae(it,"variant","danger"),ae(it,"class","send-btn my-auto ml-auto svelte-195ysuq"),ae(it,"type","submit"),it.__click=P,Ze(()=>ae(it,"disabled",!l())),z(ns),Ze(()=>pt(me,a())),_i("submit",Ke,P),le(I,L)};$t(F,I=>{s()===""?I(T):I(R,!1)})}z(k),le(r,k),Ms(),n()}Rr(["click","input"]);export{Tu as component,wu as universal};
